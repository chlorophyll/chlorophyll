var LiteGUI={root:null,content:null,panels:{},windows:[],undo_steps:[],modalbg_div:null,mainmenu:null,init:function(c){c=c||{};c.width&&c.height&&this.setWindowSize(c.width,c.height);this.container=null;c.container&&(this.container=document.getElementById(c.container));this.container||(this.container=document.body);var b=document.createElement("div");b.className="litegui-wrap fullscreen";b.style.position="relative";b.style.overflow="hidden";this.root=b;this.container.appendChild(b);b=this.modalbg_div=
document.createElement("div");this.modalbg_div.className="litemodalbg";this.root.appendChild(this.modalbg_div);b.style.display="none";b=document.createElement("div");b.className="litegui-maincontent";this.content=b;this.root.appendChild(b);c.menubar&&this.createMenubar();c.gui_callback&&c.gui_callback();this.root.classList.contains("fullscreen")&&window.addEventListener("resize",function(a){LiteGUI.maximizeWindow()});window.addEventListener("beforeunload",function(a){for(var b in LiteGUI.windows)LiteGUI.windows[b].close();
LiteGUI.windows=[]})},trigger:function(c,b,a){var e=document.createEvent("CustomEvent");e.initCustomEvent(b,!0,!0,a);c.dispatchEvent?c.dispatchEvent(e):c.__events&&c.__events.dispatchEvent(e);return e},bind:function(c,b,a){function e(e){if(e.addEventListener)e.addEventListener(b,a);else{if(!e.__events){var c=document.createElement("span");c.widget=e;Object.defineProperty(e,"__events",{enumerable:!1,configurable:!1,writable:!1,value:c})}e.__events.addEventListener(b,a)}}if(!c)throw"Cannot bind to null";
if(!b)throw"Event bind missing";if(!a)throw"Bind callback missing";c.constructor===String&&(c=document.querySelectorAll(c));if(c.constructor===NodeList||c.constructor===Array)for(var d=0;d<c.length;++d)e(c[d]);else e(c)},unbind:function(c,b,a){c.removeEventListener?c.removeEventListener(b,a):c.__events&&c.__events.removeEventListener&&c.__events.removeEventListener(b,a)},add:function(c){this.content.appendChild(c.root||c)},remove:function(c){if(c){if(c.constructor===String)for(var b=document.querySelectorAll(c),
a=0;a<b.length;++a)(c=b[a])&&c.parentNode&&c.parentNode.removeChild(c);if(c.constructor===Array||c.constructor===NodeList)for(a=0;a<c.length;++a)LiteGUI.remove(c[a]);else c.root&&c.root.parentNode?c.root.parentNode.removeChild(c.root):c.parentNode&&c.parentNode.removeChild(c)}},getById:function(c){return document.getElementById(c)},createMenubar:function(){this.menubar=new LiteGUI.Menubar("mainmenubar");this.add(this.menubar)},setWindowSize:function(c,b){var a=this.root.style;if(c&&b)a.width=c+"px",
a.height=b+"px",a.boxShadow="0 0 4px black",this.root.classList.remove("fullscreen");else{if(this.root.classList.contains("fullscreen"))return;this.root.classList.add("fullscreen");a.width="100%";a.height="100%";a.boxShadow="0 0 0"}LiteGUI.trigger(LiteGUI,"resized")},maximizeWindow:function(){this.setWindowSize()},setCursor:function(c){this.root.style.cursor=c},isCursorOverElement:function(c,b){var a=c.pageX,e=c.pageY,d=b.getClientRects()[0];return d?e>d.top&&e<d.top+d.height&&a>d.left&&a<d.left+
d.width?!0:!1:!1},getRect:function(c){return c.getClientRects()[0]},toClipboard:function(c,b){c&&c.constructor!==String&&(c=JSON.stringify(c));var a=null,e=!1;if(!b)try{document.queryCommandSupported("copy"),a=document.createElement("input"),a.type="text",a.style.opacity=0,a.value=c,document.body.appendChild(a),a.select(),e=document.execCommand("copy"),console.log(e?"saved to clipboard":"problem saving to clipboard"),document.body.removeChild(a)}catch(d){a&&document.body.removeChild(a),console.warn("Oops, unable to copy using the true clipboard")}localStorage.setItem("litegui_clipboard",
c)},getLocalClipboard:function(){var c=localStorage.getItem("litegui_clipboard");return c?"{"==c[0]?JSON.parse(c):c:null},addCSS:function(c){if(c)if(c.constructor===String){var b=document.createElement("style");b.type="text/css";b.innerHTML=c;document.getElementsByTagName("head")[0].appendChild(b)}else for(b in c)document.body.style[b]=c[b]},requireCSS:function(c,b){for("string"==typeof c&&(c=[c]);c.length;){var a=document.createElement("link");a.rel="stylesheet";a.type="text/css";a.href=c.shift(1);
a.media="all";document.getElementsByTagName("head")[0].appendChild(a);0==c.length&&(a.onload=b)}},request:function(c){var b=c.dataType||"text";"json"==b?b="text":"xml"==b?b="text":"binary"==b&&(b="arraybuffer",c.mimeType="application/octet-stream");var a=new XMLHttpRequest;a.open(c.data?"POST":"GET",c.url,!0);b&&(a.responseType=b);c.mimeType&&a.overrideMimeType(c.mimeType);a.onload=function(b){b=this.response;if(200!=this.status)b="Error "+this.status,c.error&&c.error(b),LEvent.trigger(a,"fail",this.status);
else{if("json"==c.dataType)try{b=JSON.parse(b)}catch(d){if(c.error)c.error(d);else throw d;}else if("xml"==c.dataType)try{b=(new DOMParser).parseFromString(b,"text/xml")}catch(f){if(c.error)c.error(f);else throw f;}c.success&&c.success.call(this,b,this)}};a.onerror=function(a){c.error&&c.error(a)};a.send(c.data);return a},requestText:function(c,b,a){return this.request({url:c,dataType:"text",success:b,error:a})},requestJSON:function(c,b,a){return this.request({url:c,dataType:"json",success:b,error:a})},
requestBinary:function(c,b,a){return this.request({url:c,dataType:"binary",success:b,error:a})},requireScript:function(c,b,a,e){if(!c)throw"invalid URL";c.constructor===String&&(c=[c]);var d=c.length,f=[],g;for(g in c){var h=document.createElement("script");h.num=g;h.type="text/javascript";h.src=c[g];h.async=!1;h.onload=function(a){d--;f.push(this);d?e&&e(this.src,this.num):b&&b(f)};a&&(h.onerror=function(b){a(b,this.src,this.num)});document.getElementsByTagName("head")[0].appendChild(h)}},requireScriptSerial:function(c,
b,a){function e(){var f=document.createElement("script");f.type="text/javascript";f.src=c.shift(1);f.onload=function(f){c.length?(a&&a(c[0],c.length),e()):(d.push(this),b&&b(d))};document.getElementsByTagName("head")[0].appendChild(f)}"string"==typeof c&&(c=[c]);var d=[];e()},newDiv:function(c,b){return this.createElement("div",c,b)},createElement:function(c,b,a,e,d){c=document.createElement(c);if(b){b=b.split(" ");for(var f=0;f<b.length;f++)"."==b[f][0]?c.classList.add(b[f].substr(1)):c.id="#"==
b[f][0]?b[f].substr(1):b[f]}c.root=c;a&&(c.innerHTML=a);c.add=function(a){this.appendChild(a.root||a)};if(e)if(e.constructor===String)c.setAttribute("style",e);else for(f in e)c.style[f]=e[f];if(d)for(f in d)c.addEventListener(f,d[f]);return c},createButton:function(c,b,a,e){var d=document.createElement("button");d.className="litegui litebutton button";if(c){c=c.split(" ");for(var f=0;f<c.length;f++)"."==c[f][0]?d.classList.add(c[f].substr(1)):d.id="#"==c[f][0]?c[f].substr(1):c[f]}d.root=d;void 0!==
b&&(d.innerHTML=b);a&&d.addEventListener("click",a);if(e)if(e.constructor===String)d.setAttribute("style",e);else for(f in e)d.style[f]=e[f];return d},newWindow:function(c,b,a,e){e=e||{};b=window.open("","","width="+b+", height="+a+", location=no, status=no, menubar=no, titlebar=no, fullscreen=yes");b.document.write("<html><head><title>"+c+"</title>");a=document.querySelectorAll("link[rel='stylesheet'],style");for(c=0;c<a.length;c++)b.document.write(a[c].outerHTML);if(e.scripts)for(a=document.querySelectorAll("script"),
c=0;c<a.length;c++)a[c].src&&b.document.write(a[c].outerHTML);b.document.write("</head><body>"+(e.content||"")+"</body></html>");b.document.close();return b},showModalBackground:function(c){LiteGUI.modalbg_div&&(LiteGUI.modalbg_div.style.display=c?"block":"none")},showMessage:function(c,b){b=b||{};b.title=b.title||"Attention";b.content=c;b.close="fade";var a=new LiteGUI.Dialog(null,b);b.noclose||a.addButton("Close",{close:!0});a.makeModal("fade");return a},popup:function(c,b){b=b||{};b.min_height=
140;"string"==typeof c&&(c="<p>"+c+"</p>");b.content=c;b.close="fade";var a=new LiteGUI.Dialog("info_message",b);b.noclose||a.addButton("Close",{close:!0});a.show();return a},alert:function(c,b){b=b||{};b.className="alert";b.title=b.title||"Alert";b.width=b.width||280;b.height=b.height||140;"string"==typeof c&&(c="<p>"+c+"</p>");LiteGUI.remove(".litepanel.alert");return LiteGUI.showMessage(c,b)},confirm:function(c,b,a){function e(a){a="yes"==this.dataset.value;d.close();b&&b(a)}a=a||{};a.className=
"alert";a.title=a.title||"Confirm";a.width=a.width||280;"string"==typeof c&&(c="<p>"+c+"</p>");a.noclose=!0;var d=this.showMessage(c+"<button class='litebutton' data-value='yes' style='width:45%; margin-left: 10px'>Yes</button><button class='litebutton' data-value='no' style='width:45%'>No</button>",a);d.content.style.paddingBottom="10px";c=d.content.querySelectorAll("button");for(a=0;a<c.length;a++)c[a].addEventListener("click",e);return d},prompt:function(c,b,a){function e(){var a=h.value;this.dataset&&
"cancel"==this.dataset.value&&(a=null);g.close();b&&b(a)}a=a||{};a.className="alert";a.title=a.title||"Prompt";a.width=a.width||280;"string"==typeof c&&(c="<p>"+c+"</p>");var d=a.value||"",f="<input type='text' value='"+d+"'/>";a.textarea&&(f="<textarea class='textfield' style='width:95%'>"+d+"</textarea>");a.noclose=!0;var g=this.showMessage(c+("<p>"+f+"</p><button class='litebutton' data-value='accept' style='width:45%; margin-left: 10px; margin-bottom: 10px'>Accept</button><button class='litebutton' data-value='cancel' style='width:45%'>Cancel</button>"),
a);c=g.content.querySelectorAll("button");for(a=0;a<c.length;a++)c[a].addEventListener("click",e);var h=g.content.querySelector("input,textarea");h.addEventListener("keydown",function(a){a||(a=window.event);if("13"==(a.keyCode||a.which))return e(),!1},!0);h.focus();return g},downloadFile:function(c,b,a){if(b){a||(a=b.constructor===String?"text/plain":"application/octet-stream");var e=null,e=b.constructor!==File&&b.constructor!==Blob?new Blob([b],{type:a}):b,d=URL.createObjectURL(e);b=document.createElement("a");
b.setAttribute("href",d);b.setAttribute("download",c);b.style.display="none";document.body.appendChild(b);b.click();document.body.removeChild(b);setTimeout(function(){URL.revokeObjectURL(d)},6E4)}else console.warn("No file provided to download")},getUrlVars:function(){for(var c=[],b,a=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),e=0;e<a.length;e++)b=a[e].split("="),c.push(b[0]),c[b[0]]=b[1];return c},getUrlVar:function(c){return LiteGUI.getUrlVars()[c]},focus:function(c){c.focus()},
blur:function(c){c.blur()},draggable:function(c,b,a,e,d){function f(b){if("mousedown"==b.type){k||(l=(k=c.getClientRects()[0])?k.left:0,n=k?k.top:0);if(d&&!1==d(c,b))return b.stopPropagation(),b.preventDefault(),!1;g=b.clientX;h=b.clientY;document.addEventListener("mousemove",f);document.addEventListener("mouseup",f);a&&a(c,b);b.stopPropagation();b.preventDefault();return!1}if("mouseup"==b.type)document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",f),e&&e(c,b);else if("mousemove"==
b.type){var m=b.clientX-g,q=b.clientY-h;g=b.clientX;h=b.clientY;l+=m;n+=q;c.style.left=l+"px";c.style.top=n+"px"}}b=b||c;b.addEventListener("mousedown",f);b.style.cursor="move";var g=0,h=0,k=c.getClientRects()[0],l=k?k.left:0,n=k?k.top:0;c.style.position="absolute";c.style.left=l+"px";c.style.top=n+"px"},cloneObject:function(c,b){var a=b||{},e;for(e in c)if("_"!=e[0]&&"jQuery"!=e.substr(0,6)){var d=c[e];if(null==d)a[e]=null;else if(!isFunction(d))if("number"==typeof d||"string"==typeof d)a[e]=d;else if(d.constructor==
Float32Array)a[e]=Array.apply([],d);else if(isArray(d))a[e]&&a[e].constructor==Float32Array?a[e].set(d):a[e]=JSON.parse(JSON.stringify(d));else try{a[e]=JSON.parse(JSON.stringify(d))}catch(f){console.error(f)}}return a},safeName:function(c){return String(c).replace(/[\s\.]/g,"")},special_codes:{close:"&#10005;",navicon:"&#9776;",refresh:"&#8634;",gear:"&#9881;",open_folder:"&#128194;"},htmlEncode:function(c){var b=document.createElement("div");b.innerHTML=c;return b.innerText},htmlDecode:function(c){var b=
document.createElement("div");b.innerText=c;return b.innerHTML},sizeToCSS:function(c){return void 0===c||null===c?null:c.constructor===String?c:0<=c?(c|0)+"px":"calc( 100% - "+Math.abs(c|0)+"px )"},createDropArea:function(c,b,a,e){function d(b){c.addEventListener("dragexit",d);c.addEventListener("dragover",d);c.addEventListener("drop",f);b.stopPropagation();b.preventDefault();"dragenter"==b.type&&a&&a(b,this);"dragexit"==b.type&&e&&e(b,this)}function f(a){a.stopPropagation();a.preventDefault();c.removeEventListener("dragexit",
d);c.removeEventListener("dragover",d);c.removeEventListener("drop",f);var e=void 0;b&&(e=b(a));if(e)return a.stopPropagation(),a.stopImmediatePropagation(),!0}c.addEventListener("dragenter",d)}};function purgeElement(c,b){var a=c.attributes,e,d;if(a)for(e=a.length-1;0<=e;e-=1)d=a[e].name,"function"===typeof c[d]&&(c[d]=null);if(a=c.childNodes)for(a=a.length,e=0;e<a;e+=1)purgeElement(c.childNodes[e])}
"undefined"==typeof escapeHtmlEntities&&(escapeHtmlEntities=function(c){return c.replace(/[\u00A0-\u2666<>\&]/g,function(b){return"&"+(escapeHtmlEntities.entityTable[b.charCodeAt(0)]||"#"+b.charCodeAt(0))+";"})},escapeHtmlEntities.entityTable={34:"quot",38:"amp",39:"apos",60:"lt",62:"gt",160:"nbsp",161:"iexcl",162:"cent",163:"pound",164:"curren",165:"yen",166:"brvbar",167:"sect",168:"uml",169:"copy",170:"ordf",171:"laquo",172:"not",173:"shy",174:"reg",175:"macr",176:"deg",177:"plusmn",178:"sup2",
179:"sup3",180:"acute",181:"micro",182:"para",183:"middot",184:"cedil",185:"sup1",186:"ordm",187:"raquo",188:"frac14",189:"frac12",190:"frac34",191:"iquest",192:"Agrave",193:"Aacute",194:"Acirc",195:"Atilde",196:"Auml",197:"Aring",198:"AElig",199:"Ccedil",200:"Egrave",201:"Eacute",202:"Ecirc",203:"Euml",204:"Igrave",205:"Iacute",206:"Icirc",207:"Iuml",208:"ETH",209:"Ntilde",210:"Ograve",211:"Oacute",212:"Ocirc",213:"Otilde",214:"Ouml",215:"times",216:"Oslash",217:"Ugrave",218:"Uacute",219:"Ucirc",
220:"Uuml",221:"Yacute",222:"THORN",223:"szlig",224:"agrave",225:"aacute",226:"acirc",227:"atilde",228:"auml",229:"aring",230:"aelig",231:"ccedil",232:"egrave",233:"eacute",234:"ecirc",235:"euml",236:"igrave",237:"iacute",238:"icirc",239:"iuml",240:"eth",241:"ntilde",242:"ograve",243:"oacute",244:"ocirc",245:"otilde",246:"ouml",247:"divide",248:"oslash",249:"ugrave",250:"uacute",251:"ucirc",252:"uuml",253:"yacute",254:"thorn",255:"yuml",402:"fnof",913:"Alpha",914:"Beta",915:"Gamma",916:"Delta",917:"Epsilon",
918:"Zeta",919:"Eta",920:"Theta",921:"Iota",922:"Kappa",923:"Lambda",924:"Mu",925:"Nu",926:"Xi",927:"Omicron",928:"Pi",929:"Rho",931:"Sigma",932:"Tau",933:"Upsilon",934:"Phi",935:"Chi",936:"Psi",937:"Omega",945:"alpha",946:"beta",947:"gamma",948:"delta",949:"epsilon",950:"zeta",951:"eta",952:"theta",953:"iota",954:"kappa",955:"lambda",956:"mu",957:"nu",958:"xi",959:"omicron",960:"pi",961:"rho",962:"sigmaf",963:"sigma",964:"tau",965:"upsilon",966:"phi",967:"chi",968:"psi",969:"omega",977:"thetasym",
978:"upsih",982:"piv",8226:"bull",8230:"hellip",8242:"prime",8243:"Prime",8254:"oline",8260:"frasl",8472:"weierp",8465:"image",8476:"real",8482:"trade",8501:"alefsym",8592:"larr",8593:"uarr",8594:"rarr",8595:"darr",8596:"harr",8629:"crarr",8656:"lArr",8657:"uArr",8658:"rArr",8659:"dArr",8660:"hArr",8704:"forall",8706:"part",8707:"exist",8709:"empty",8711:"nabla",8712:"isin",8713:"notin",8715:"ni",8719:"prod",8721:"sum",8722:"minus",8727:"lowast",8730:"radic",8733:"prop",8734:"infin",8736:"ang",8743:"and",
8744:"or",8745:"cap",8746:"cup",8747:"int",8756:"there4",8764:"sim",8773:"cong",8776:"asymp",8800:"ne",8801:"equiv",8804:"le",8805:"ge",8834:"sub",8835:"sup",8836:"nsub",8838:"sube",8839:"supe",8853:"oplus",8855:"otimes",8869:"perp",8901:"sdot",8968:"lceil",8969:"rceil",8970:"lfloor",8971:"rfloor",9001:"lang",9002:"rang",9674:"loz",9824:"spades",9827:"clubs",9829:"hearts",9830:"diams",338:"OElig",339:"oelig",352:"Scaron",353:"scaron",376:"Yuml",710:"circ",732:"tilde",8194:"ensp",8195:"emsp",8201:"thinsp",
8204:"zwnj",8205:"zwj",8206:"lrm",8207:"rlm",8211:"ndash",8212:"mdash",8216:"lsquo",8217:"rsquo",8218:"sbquo",8220:"ldquo",8221:"rdquo",8222:"bdquo",8224:"dagger",8225:"Dagger",8240:"permil",8249:"lsaquo",8250:"rsaquo",8364:"euro"});
function beautifyCode(c,b,a){b=b||"abstract else instanceof super boolean enum int switch break export interface synchronized byte extends let this case false long throw catch final native throws char finally new transient class float null true const for package try continue function private typeof debugger goto protected var default if public void delete implements return volatile do import short while double in static with".split(" ");c=c.replace(/(\w+)/g,function(a){return-1!=b.indexOf(a)?"<span class='rsv'>"+
a+"</span>":a});c=c.replace(/([0-9]+)/g,function(a){return"<span class='num'>"+a+"</span>"});c=c.replace(/(\w+\.\w+)/g,function(a){a=a.split(".");return"<span class='obj'>"+a[0]+"</span>.<span class='prop'>"+a[1]+"</span>"});c=c.replace(/(\w+)\(/g,function(a){return"<span class='prop'>"+a.substr(0,a.length-1)+"</span>("});c=c.replace(/(\"(\\.|[^\"])*\")/g,function(a){return"<span class='str'>"+a+"</span>"});c=c.replace(/(\/\/[a-zA-Z0-9\?\!\(\)_ ]*)/g,function(a){return"<span class='cmnt'>"+a+"</span>"});
a||(c="<style>.obj { color: #79B; } .prop { color: #B97; }\t.str,.num { color: #A79; } .cmnt { color: #798; } .rsv { color: #9AB; } </style>"+c);return c}
function beautifyJSON(c,b){"object"==typeof c&&(c=JSON.stringify(c));var a=["false","true","null"];c=c.replace(/(\w+)/g,function(b){return-1!=a.indexOf(b)?"<span class='rsv'>"+b+"</span>":b});c=c.replace(/([0-9]+)/g,function(a){return"<span class='num'>"+a+"</span>"});c=c.replace(/(\w+\.\w+)/g,function(a){a=a.split(".");return"<span class='obj'>"+a[0]+"</span>.<span class='prop'>"+a[1]+"</span>"});c=c.replace(/(\"(\\.|[^\"])*\")/g,function(a){return"<span class='str'>"+a+"</span>"});c=c.replace(/(\/\/[a-zA-Z0-9\?\!\(\)_ ]*)/g,
function(a){return"<span class='cmnt'>"+a+"</span>"});b||(c="<style>.obj { color: #79B; } .prop { color: #B97; }\t.str { color: #A79; } .num { color: #B97; } .cmnt { color: #798; } .rsv { color: #9AB; } </style>"+c);return c}function dataURItoBlob(c){for(var b=c.indexOf(","),a=atob(c.substr(b+1)),e=new ArrayBuffer(a.length),d=new Uint8Array(e),f=a.length,g=0;g<f;g++)d[g]=a.charCodeAt(g);c=c.substr(5,b-5);c=c.substr(0,c.length-7);return new Blob([e],{type:c})}
(function(){function c(a,b){b=b||{};var c=document.createElement("div");c.className="litegui searchbox";c.innerHTML="<input value='"+a+"' placeholder='"+(null!=b.placeholder?b.placeholder:"Search")+"'/>";this.input=c.querySelector("input");this.root=c;var g=this;$(this.input).change(function(a){a=a.target.value;b.callback&&b.callback.call(g,a)})}function b(a,b){function c(a){var b=this.value;b&&b.has_submenu&&g.call(this,a)}function g(a){var c=this.value,e=!0;h.current_submenu&&h.current_submenu.close(a);
if(b.callback){var f=b.callback.call(h,c,b,a);!0===f&&(e=!1)}if(c&&(c.callback&&!b.ignore_item_callbacks&&!0!==c.disabled&&(f=c.callback.call(this,c,b,a),!0===f&&(e=!1)),c.submenu)){if(!c.submenu.options)throw"ContextMenu submenu needs options";new LiteGUI.ContextMenu(c.submenu.options,{callback:c.submenu.callback,event:a,parentMenu:h,ignore_item_callbacks:c.submenu.ignore_item_callbacks,title:c.submenu.title,autoopen:b.autoopen});e=!1}e&&!h.lock&&h.close()}this.options=b=b||{};var h=this;b.parentMenu&&
(this.parentMenu=b.parentMenu,this.parentMenu.lock=!0,this.parentMenu.current_submenu=this);var k=document.createElement("div");k.className="litecontextmenu litemenubar-panel";k.style.minWidth=100;k.style.minHeight=100;k.style.pointerEvents="none";setTimeout(function(){k.style.pointerEvents="auto"},100);k.addEventListener("mouseup",function(a){a.preventDefault();return!0},!0);k.addEventListener("contextmenu",function(a){if(2!=a.button)return!1;a.preventDefault();return!1},!0);k.addEventListener("mousedown",
function(a){if(2==a.button)return h.close(),a.preventDefault(),!0},!0);this.root=k;if(b.title){var l=document.createElement("div");l.className="litemenu-title";l.innerHTML=b.title;k.appendChild(l)}var n=0,p;for(p in a){l=document.createElement("div");l.className="litemenu-entry submenu";var m=a.constructor==Array?a[p]:p,q=a[p],r=!1;if(null===q)l.classList.add("separator");else{l.innerHTML=q&&q.title?q.title:m;if(l.value=q)q.disabled&&(r=!0,l.classList.add("disabled")),(q.submenu||q.has_submenu)&&
l.classList.add("has_submenu");"function"==typeof q?(l.dataset.value=m,l.onclick_callback=q):l.dataset.value=q}k.appendChild(l);r||l.addEventListener("click",g);b.autoopen&&l.addEventListener("mouseenter",c);n++}k.addEventListener("mouseleave",function(a){h.lock||h.close(a)});l=document;b.event&&(l=b.event.target.ownerDocument);l||(l=document);l.body.appendChild(k);l=b.left||0;n=b.top||0;b.event&&(l=b.event.pageX-10,n=b.event.pageY-10,b.title&&(n-=20),b.parentMenu&&(l=$(b.parentMenu.root).position().left+
$(b.parentMenu.root).width()),p=LiteGUI.getRect(document.body),m=LiteGUI.getRect(k),l>p.width-m.width-10&&(l=p.width-m.width-10),n>p.height-m.height-10&&(n=p.height-m.height-10));k.style.left=l+"px";k.style.top=n+"px"}function a(a,b,c){c=c||{};var g=this.root=document.createElement("ul");g.id=a;g.className="litelist";this.items=[];var h=this;this.callback=c.callback;for(var k in b){a=document.createElement("li");a.className="list-item";a.data=b[k];a.dataset.value=b[k];var l="";"string"==typeof b[k]?
l=b[k]+"<span class='arrow'></span>":(l=(b[k].name||b[k].title||"")+"<span class='arrow'></span>",b[k].id&&(a.id=b[k].id));a.innerHTML=l;a.addEventListener("click",function(){$(g).find(".list-item.selected").removeClass("selected");this.classList.add("selected");$(h.root).trigger("wchanged",this);h.callback&&h.callback(this.data)});g.appendChild(a)}c.parent&&(c.parent.root?c.parent.root.appendChild(g):c.parent.appendChild(g))}LiteGUI.Button=function(a,b){b=b||{};"function"===typeof b&&(b={callback:b});
var c=this,g=document.createElement("div");g.className="litegui button";this.root=g;var h=document.createElement("button");h.className="litebutton";this.content=h;g.appendChild(h);h.innerHTML=a;h.addEventListener("click",function(a){c.click()});this.click=function(){b.callback&&b.callback.call(c)}};c.prototype.setValue=function(a){$(this.input).val(a).change()};c.prototype.getValue=function(){return $(this.input).val()};LiteGUI.SearchBox=c;b.prototype.close=function(a,b){this.root.parentNode&&this.root.parentNode.removeChild(this.root);
this.parentMenu&&!b&&(this.parentMenu.lock=!1,this.parentMenu.current_submenu=null,void 0===a?this.parentMenu.close():a&&!LiteGUI.isCursorOverElement(a,this.parentMenu.root)&&LiteGUI.trigger(this.parentMenu.root,"mouseleave",a));this.current_submenu&&this.current_submenu.close(a,!0)};LiteGUI.ContextMenu=b;LiteGUI.ContextualMenu=b;LiteGUI.Checkbox=function(a,b){this.value=a;var c=this.root=document.createElement("span");c.className="litecheckbox inputfield";c.dataset.value=a;var g=this.element=document.createElement("span");
g.className="fixed flag checkbox "+(a?"on":"off");c.appendChild(g);c.addEventListener("click",function(a){this.setValue("true"!=this.root.dataset.value);a.preventDefault();a.stopPropagation()}.bind(this));this.setValue=function(a){if(this.value!==a&&this.root.dataset.value!=a.toString()){(this.root.dataset.value=a)?(this.element.classList.remove("off"),this.element.classList.add("on")):(this.element.classList.remove("on"),this.element.classList.add("off"));var c=this.value;this.value=a;b&&b(a,c)}};
this.getValue=function(){return this.value}};LiteGUI.createLitebox=function(a,b){var c=document.createElement("span");c.className="listbox "+(a?"listopen":"listclosed");c.innerHTML=a?"&#9660;":"&#9658;";c.dataset.value=a?"open":"closed";c.addEventListener("click",function(a){a.target.setValue("open"==this.dataset.value?!1:!0);this.stopPropagation&&a.stopPropagation()});c.on_change_callback=b;c.setEmpty=function(a){a?this.classList.add("empty"):this.classList.remove("empty")};c.expand=function(){this.setValue(!0)};
c.collapse=function(){this.setValue(!1)};c.setValue=function(a){this.dataset.value!=(a?"open":"closed")&&(a?(this.dataset.value="open",this.innerHTML="&#9660;",this.classList.add("listopen"),this.classList.remove("listclosed")):(this.dataset.value="closed",this.innerHTML="&#9658;",this.classList.remove("listopen"),this.classList.add("listclosed")),b&&b(this.dataset.value))};c.getValue=function(){return this.dataset.value};return c};a.prototype.getSelectedItem=function(){return this.root.querySelector(".list-item.selected")};
a.prototype.setSelectedItem=function(a){for(var b=this.root.querySelectorAll(".list-item"),c=0;c<b.length;c++){var g=b[c];if(g.data==a){LiteGUI.trigger(g,"click");break}}};LiteGUI.List=a;LiteGUI.Slider=function(a,b){function c(a){var e=k.getClientRects()[0].width,f=b.min||0;l.setValue(a/e*((b.max||1)-f)+f)}function g(a){var b=k.getClientRects()[0];c((void 0===a.x?a.pageX:a.x)-b.left);a.preventDefault();return!1}function h(a){var b=n||document;n=null;b.removeEventListener("mousemove",g);b.removeEventListener("mouseup",
h);a.preventDefault();return!1}b=b||{};var k=document.createElement("canvas");k.className="slider "+(b.extraclass?b.extraclass:"");k.width=100;k.height=1;k.style.position="relative";k.style.width="calc( 100% - 2em )";k.style.height="1.2em";this.root=k;var l=this;this.value=a;this.setValue=function(a,c){var e=k.getContext("2d"),f=b.min||0,g=b.max||1;a<f?a=f:a>g&&(a=g);f=(a-f)/(g-f);e.clearRect(0,0,k.width,k.height);e.fillStyle="#999";e.fillRect(0,0,k.width*f,k.height);e.fillStyle="#DA2";e.fillRect(k.width*
f-1,0,2,k.height);a!=this.value&&(this.value=a,c||LiteGUI.trigger(this.root,"change",a))};var n=null;k.addEventListener("mousedown",function(a){var b;a.offsetX?b=a.offsetX:a.layerX&&(b=a.layerX);c(b);n=k.ownerDocument;n.addEventListener("mousemove",g);n.addEventListener("mouseup",h)});this.setValue(a)};LiteGUI.LineEditor=function(a,b){function c(a){return[q.width*((m.xrange[1]-m.xrange[0])*a[0]+m.xrange[0]),q.height*((m.yrange[1]-m.yrange[0])*a[1]+m.yrange[0])]}function g(a){return[(a[0]/q.width-
m.xrange[0])/(m.xrange[1]-m.xrange[0]),(a[1]/q.height-m.yrange[0])/(m.yrange[1]-m.yrange[0])]}function h(a){var b=q.getBoundingClientRect(),c=a.clientX-b.left,e=a.clientY-b.top;0>c?c=0:c>q.width&&(c=q.width);0>e?e=0:e>q.height&&(e=q.height);if(-1!=r&&n([a.clientX-b.left,a.clientY-b.top],[c,e])>0.5*q.height)m.value.splice(r,1),k(a);else{b=g([-(s[0]-c),s[1]-e]);if(-1!=r){var d=m.xrange[0],f=m.xrange[1];m.no_trespassing&&(0<r&&(d=m.value[r-1][0]),r<m.value.length-1&&(f=m.value[r+1][0]));var h=m.value[r];
h[0]+=b[0];h[1]+=b[1];h[0]<d?h[0]=d:h[0]>f&&(h[0]=f);h[1]<m.yrange[0]?h[1]=m.yrange[0]:h[1]>m.yrange[1]&&(h[1]=m.yrange[1])}p();m.redraw();s[0]=c;s[1]=e;l();a.preventDefault();a.stopPropagation()}}function k(a){r=-1;m.redraw();$(document).unbind("mousemove",h);$(document).unbind("mouseup",k);l();a.preventDefault();a.stopPropagation()}function l(){b.callback?b.callback.call(m,m.value):$(m).change()}function n(a,b){return Math.sqrt(Math.pow(b[0]-a[0],2)+Math.pow(b[1]-a[1],2))}function p(){var a=null;
-1!=r&&(a=m.value[r]);m.value.sort(function(a,b){return a[0]>b[0]});a&&(r=m.value.indexOf(a))}b=b||{};var m=document.createElement("div");m.className="curve "+(b.extraclass?b.extraclass:"");m.style.minHeight="50px";m.style.width=b.width||"100%";m.bgcolor=b.bgcolor||"#222";m.pointscolor=b.pointscolor||"#5AF";m.linecolor=b.linecolor||"#444";m.value=a||[];m.xrange=b.xrange||[0,1];m.yrange=b.yrange||[0,1];m.defaulty=null!=b.defaulty?b.defaulty:0.5;m.no_trespassing=b.no_trespassing||!1;m.show_samples=
b.show_samples||0;m.options=b;var q=document.createElement("canvas");q.width=b.width||200;q.height=b.height||50;m.appendChild(q);m.canvas=q;$(q).bind("mousedown",function(a){$(document).bind("mousemove",h);$(document).bind("mouseup",k);for(var b=q.getBoundingClientRect(),e=a.clientX-b.left,b=a.clientY-b.top,d=q.height-b,l=1E5,A=-1,x=0;x<m.value.length;x++){var w=c(m.value[x]),w=n([e,d],w);w<l&&8>w&&(l=w,A=x)}r=A;-1==r&&(d=g([e,q.height-b]),m.value.push(d),p(),r=m.value.indexOf(d));s=[e,b];m.redraw();
a.preventDefault();a.stopPropagation()});$(m).resize(function(a){q.width=$(this).width();q.height=$(this).height();m.redraw()});m.getValueAt=function(a){if(a<m.xrange[0]||a>m.xrange[1])return m.defaulty;for(var b=[m.xrange[0],m.defaulty],c=0,c=0;c<m.value.length;c+=1){var e=m.value[c];if(a==e[0])return e[1];if(a<e[0])return c=(a-b[0])/(e[0]-b[0]),b[1]*(1-c)+e[1]*c;b=e}e=[m.xrange[1],m.defaulty];c=(a-b[0])/(e[0]-b[0]);return b[1]*(1-c)+e[1]*c};m.resample=function(a){var b=[];a=(m.xrange[1]-m.xrange[0])/
a;for(var c=m.xrange[0];c<=m.xrange[1];c+=a)b.push(m.getValueAt(c));return b};m.addValue=function(a){for(var b=0;b<m.value;b++)if(!(m.value[b][0]<a[0])){m.value.splice(b,0,a);redraw();return}m.value.push(a);redraw()};var r=-1;m.redraw=function(){var a=q.getContext("2d");a.setTransform(1,0,0,1,0,0);a.translate(0,q.height);a.scale(1,-1);a.fillStyle=m.bgcolor;a.fillRect(0,0,q.width,q.height);a.strokeStyle=m.linecolor;a.beginPath();var b=c([m.xrange[0],m.defaulty]);a.moveTo(b[0],b[1]);for(var e in m.value)b=
m.value[e],b=c(b),a.lineTo(b[0],b[1]);b=c([m.xrange[1],m.defaulty]);a.lineTo(b[0],b[1]);a.stroke();for(e=0;e<m.value.length;e+=1)b=m.value[e],b=c(b),a.fillStyle=r==e?"white":m.pointscolor,a.beginPath(),a.arc(b[0],b[1],r==e?4:2,0,2*Math.PI),a.fill();if(m.show_samples){var d=m.resample(m.show_samples);a.fillStyle="#888";for(e=0;e<d.length;e+=1)b=[(m.xrange[1]-m.xrange[0])/m.show_samples*e+m.xrange[0],d[e]],b=c(b),a.beginPath(),a.arc(b[0],b[1],2,0,2*Math.PI),a.fill()}};var s=[0,0];m.redraw();return m}})();
(function(){function c(b,a){!a&&b&&b.constructor!==String&&(a=b,b=null);a=a||{};var c=document.createElement("div");c.className="litearea";b&&(c.id=b);a.id&&(c.id=b);a.className&&(c.className+=" "+a.className);this.root=c;this.root.litearea=this;var d=a.width||"100%",f=a.height||"100%";0>d&&(d="calc( 100% - "+Math.abs(d)+"px)");0>f&&(f="calc( 100% - "+Math.abs(f)+"px)");c.style.width=d;c.style.height=f;this.options=a;var g=this;this._computed_size=[this.root.offsetWidth,this.root.offserHeight];c=
document.createElement("div");a.content_id&&(c.id=a.content_id);c.className="liteareacontent";c.style.width="100%";c.style.height="100%";this.root.appendChild(c);this.content=c;this.split_direction="none";this.sections=[];a.autoresize&&LiteGUI.bind(LiteGUI,"resized",function(){g.onResize()})}c.splitbar_size=4;c.prototype.getSection=function(b){b=b||0;return this.sections.length>b?this.sections[b]:null};c.prototype.onResize=function(b){var a=[this.root.offsetWidth,this.root.offsetHeight];b&&this._computed_size&&
a[0]==this._computed_size[0]&&a[1]==this._computed_size[1]||this.sendResizeEvent(b)};c.prototype.sendResizeEvent=function(b){if(this.sections.length)for(var a in this.sections)this.sections[a].onResize(b);else for(b=0;b<this.root.childNodes.length;b++)if(a=this.root.childNodes[b],a.litearea)a.litearea.onResize();else LiteGUI.trigger(a,"resize");if(this.onresize)this.onresize()};c.prototype.getWidth=function(){return this.root.offsetWidth};c.prototype.getHeight=function(){return this.root.offsetHeight};
c.prototype.isVisible=function(){return"none"!=this.root.style.display};c.prototype.adjustHeight=function(){if(this.root.parentNode){var b=this.root.getClientRects()[0].top;this.root.style.height="calc( 100% - "+b+"px )"}else console.error("Cannot adjust height of LiteGUI.Area without parent")};c.prototype.split=function(b,a,e){function d(a){var b=m.root.ownerDocument;b.addEventListener("mousemove",f);b.addEventListener("mouseup",g);q[0]=a.pageX;q[1]=a.pageY;a.stopPropagation();a.preventDefault()}
function f(a){"horizontal"==b?q[0]!=a.pageX&&m.moveSplit(q[0]-a.pageX):"vertical"==b&&q[1]!=a.pageY&&m.moveSplit(a.pageY-q[1]);q[0]=a.pageX;q[1]=a.pageY;a.stopPropagation();a.preventDefault();if(m.options.immediateResize||m.options.inmediateResize)m.onResize()}function g(a){a=m.root.ownerDocument;a.removeEventListener("mousemove",f);a.removeEventListener("mouseup",g);m.onResize()}if(!b||b.constructor!==String)throw"First parameter must be a string: 'vertical' or 'horizontal'";if(!a)throw"sizes must be an array";
if("vertical"!=b&&"horizontal"!=b)throw"First parameter must be a string: 'vertical' or 'horizontal'";if(this.sections.length)throw"cannot split twice";var h=new LiteGUI.Area(null,{content_id:this.content.id});h.root.style.display="inline-block";var k=new LiteGUI.Area;k.root.style.display="inline-block";var l="",n=null,p=null;e&&(l=" - "+(c.splitbar_size+2)+"px",n=document.createElement("div"),n.className="litesplitbar "+b,"vertical"==b?n.style.height=c.splitbar_size+"px":n.style.width=c.splitbar_size+
"px",this.splitbar=n,n.addEventListener("mousedown",d));a=a||["50%",null];"vertical"==b?(h.root.style.width="100%",k.root.style.width="100%",null==a[0]?(p=a[1],"number"==typeof p&&(p=a[1]+"px"),h.root.style.height="-moz-calc( 100% - "+p+l+" )",h.root.style.height="-webkit-calc( 100% - "+p+l+" )",h.root.style.height="calc( 100% - "+p+l+" )",k.root.style.height=p,k.size=p,p=h):null==a[1]?(p=a[0],"number"==typeof p&&(p=a[0]+"px"),h.root.style.height=p,h.size=p,k.root.style.height="-moz-calc( 100% - "+
p+l+" )",k.root.style.height="-webkit-calc( 100% - "+p+l+" )",k.root.style.height="calc( 100% - "+p+l+" )",p=k):(l=a[0],"number"==typeof l&&(l=a[0]+"px"),e=a[1],"number"==typeof e&&(e=a[1]+"px"),h.root.style.height=l,h.size=l,k.root.style.height=e,k.size=e)):(h.root.style.height="100%",k.root.style.height="100%",null==a[0]?(p=a[1],"number"==typeof p&&(p=a[1]+"px"),h.root.style.width="-moz-calc( 100% - "+p+l+" )",h.root.style.width="-webkit-calc( 100% - "+p+l+" )",h.root.style.width="calc( 100% - "+
p+l+" )",k.root.style.width=p,k.size=a[1],p=h):null==a[1]?(p=a[0],"number"==typeof p&&(p=a[0]+"px"),h.root.style.width=p,h.size=p,k.root.style.width="-moz-calc( 100% - "+p+l+" )",k.root.style.width="-webkit-calc( 100% - "+p+l+" )",k.root.style.width="calc( 100% - "+p+l+" )",p=k):(l=a[0],"number"==typeof l&&(l=a[0]+"px"),e=a[1],"number"==typeof e&&(e=a[1]+"px"),h.root.style.width=l,h.size=l,k.root.style.width=e,k.size=e));h.root.removeChild(h.content);h.root.appendChild(this.content);h.content=this.content;
this.root.appendChild(h.root);n&&this.root.appendChild(n);this.root.appendChild(k.root);this.sections=[h,k];this.dynamic_section=p;this.direction=b;var m=this,q=[0,0]};c.prototype.hide=function(){this.root.style.display="none"};c.prototype.show=function(){this.root.style.display="block"};c.prototype.showSection=function(b){var a=this.sections[b],c=0;if(!a||"none"==a.root.style.display){c="horizontal"==this.direction?a.root.style.width:a.root.style.height;-1!=c.indexOf("calc")&&(c="50%");for(var d in this.sections)a=
this.sections[d],d==b?a.root.style.display="inline-block":"horizontal"==this.direction?a.root.style.width="calc( 100% - "+c+" - 5px)":a.root.style.height="calc( 100% - "+c+" - 5px)";this.splitbar&&(this.splitbar.style.display="inline-block");this.sendResizeEvent()}};c.prototype.hideSection=function(b){for(var a in this.sections){var c=this.sections[a];a==b?c.root.style.display="none":"horizontal"==this.direction?c.root.style.width="100%":c.root.style.height="100%"}this.splitbar&&(this.splitbar.style.display=
"none");this.sendResizeEvent()};c.prototype.moveSplit=function(b){if(this.sections){var a=this.sections[0],e=this.sections[1],d=" - "+c.splitbar_size+"px",f=this.options.minSplitSize||10;"horizontal"==this.direction?this.dynamic_section==a?(b=e.root.offsetWidth+b,b<f&&(b=f),a.root.style.width="-moz-calc( 100% - "+b+"px "+d+" )",a.root.style.width="-webkit-calc( 100% - "+b+"px "+d+" )",a.root.style.width="calc( 100% - "+b+"px "+d+" )",e.root.style.width=b+"px"):(b=a.root.offsetWidth-b,b<f&&(b=f),e.root.style.width=
"-moz-calc( 100% - "+b+"px "+d+" )",e.root.style.width="-webkit-calc( 100% - "+b+"px "+d+" )",e.root.style.width="calc( 100% - "+b+"px "+d+" )",a.root.style.width=b+"px"):"vertical"==this.direction&&(this.dynamic_section==a?(b=e.root.offsetHeight-b,b<f&&(b=f),a.root.style.height="-moz-calc( 100% - "+b+"px "+d+" )",a.root.style.height="-webkit-calc( 100% - "+b+"px "+d+" )",a.root.style.height="calc( 100% - "+b+"px "+d+" )",e.root.style.height=b+"px"):(b=a.root.offsetHeight+b,b<f&&(b=f),e.root.style.height=
"-moz-calc( 100% - "+b+"px "+d+" )",e.root.style.height="-webkit-calc( 100% - "+b+"px "+d+" )",e.root.style.height="calc( 100% - "+b+"px "+d+" )",a.root.style.height=b+"px"));LiteGUI.trigger(this.root,"split_moved");a=this.root.querySelectorAll(".litearea");for(e=0;e<a.length;++e)LiteGUI.trigger(a[e],"split_moved")}};c.prototype.addEventListener=function(b,a,c,d){return this.root.addEventListener(b,a,c,d)};c.prototype.setAreaSize=function(b,a){var e=this.sections[1],d=" - "+c.splitbar_size+"px";e.root.style.width=
"-moz-calc( 100% - "+a+d+" )";e.root.style.width="-webkit-calc( 100% - "+a+d+" )";e.root.style.width="calc( 100% - "+a+d+" )"};c.prototype.merge=function(b){if(0==this.sections.length)throw"not splitted";b=this.sections[b||0];this.root.appendChild(b.content);this.content=b.content;this.root.removeChild(this.sections[0].root);this.root.removeChild(this.sections[1].root);this.sections=[];this._computed_size=null;this.onResize()};c.prototype.add=function(b){if("string"==typeof b){var a=document.createElement("div");
a.innerHTML=b;b=a}this.content.appendChild(b.root||b)};c.prototype.query=function(b){return this.root.querySelector(b)};LiteGUI.Area=c;LiteGUI.Split=function(b,a,c){c=c||{};var d=document.createElement("div");this.root=d;d.id=b;d.className="litesplit "+(c.vertical?"vsplit":"hsplit");this.sections=[];for(var f in a)b=document.createElement("div"),b.className="split-section split"+f,"number"==typeof a[f]?c.vertical?b.style.height=a[f].toFixed(1)+"%":b.style.width=a[f].toFixed(1)+"%":"string"==typeof a[f]?
c.vertical?b.style.height=a[f]:b.style.width=a[f]:(a[f].id&&(b.id=a[f].id),c.vertical?b.style.height="Number"==typeof a[f].height?a[f].height.toFixed(1)+"%":a[f].height:b.style.width="Number"==typeof a[f].width?a[f].width.toFixed(1)+"%":a[f].width),b.add=function(a){this.appendChild(a.root||a)},this.sections.push(b),d.appendChild(b);c.parent&&(c.parent.root?c.parent.root.appendChild(d):c.parent.appendChild(d));this.getSection=function(a){return this.sections[a]}}})();
(function(){function c(b,a){a=a||{};this.menu=[];this.panels=[];this.root=document.createElement("div");this.root.id=b;this.root.className="litemenubar";this.content=document.createElement("ul");this.root.appendChild(this.content);this.is_open=!1;this.auto_open=a.auto_open||!1;this.sort_entries=a.sort_entries||!1}c.closing_time=500;c.prototype.clear=function(){this.content.innerHTML="";this.menu=[];this.panels=[]};c.prototype.attachToPanel=function(b){b.content.insertBefore(this.root,b.content.firstChild)};
c.prototype.add=function(b,a){a=a||{};"function"==typeof a&&(a={callback:a});for(var c=this.menu.length,d=b.split("/"),f=0,g=0,h=this.menu,k=null;h;){if(5<f)throw"Error: Menubar too deep";if(h.length==g){k=g={parent:k,children:[]};f==d.length-1&&(g.data=a);g.disable=function(){this.data&&(this.data.disabled=!0)};g.enable=function(){this.data&&delete this.data.disabled};g.name=d[f];h.push(g);f++;if(f==d.length)break;g.children=[];h=g.children;g=0}else{if(h[g]&&d[f]==h[g].name)if(f<d.length-1){k=h[g];
h=h[g].children;g=0;f++;continue}else{console.warn("Warning: Adding menu that already exists: "+b);break}g++}}c!=this.menu.length&&this.updateMenu()};c.prototype.remove=function(b){if(b=this.findMenu(b)){if(!b.parent||!b.parent.children)return console.warn("menu without parent?");var a=b.parent.children.indexOf(b);-1!=a&&b.parent.children.splice(a,1)}};c.prototype.separator=function(b,a){var c=this.findMenu(b);c&&c.children.push({separator:!0,order:a||10})};c.prototype.findMenu=function(b){b=b.split("/");
for(var a=0,c=0,d=this.menu;d;){if(a==b.length)return d;if(d.length<=c)break;if("*"==b[a])return d[c].children;if(b[a]==d[c].name){if(a==b.length-1)return d[c];d=d[c].children;c=0;a++}else c++}return null};c.prototype.updateMenu=function(){var b=this;this.content.innerHTML="";for(var a in this.menu){var c=document.createElement("li");c.innerHTML="<span class='icon'></span><span class='name'>"+this.menu[a].name+"</span>";this.content.appendChild(c);c.data=this.menu[a];this.menu[a].element=c;c.addEventListener("click",
function(a){var c=this.data;c.data&&c.data.callback&&"function"==typeof c.data.callback&&c.data.callback(c.data);b.is_open?(b.is_open=!1,b.hidePanels()):(b.is_open=!0,b.showMenu(c,a,this))});c.addEventListener("mouseover",function(a){b.hidePanels();(b.is_open||b.auto_open)&&b.showMenu(this.data,a,this)})}};c.prototype.hidePanels=function(){if(this.panels.length){for(var b in this.panels)LiteGUI.remove(this.panels[b]);this.panels=[]}};c.prototype.showMenu=function(b,a,c,d){d||this.hidePanels();if(b.children&&
b.children.length){var f=this;f.closing_by_leave&&clearInterval(f.closing_by_leave);var g=document.createElement("div");g.className="litemenubar-panel";var h=[],k;for(k in b.children)h.push(b.children[k]);this.sort_entries&&h.sort(function(a,b){var c=10,e=10;a&&a.data&&null!=a.data.order&&(c=a.data.order);a&&a.separator&&null!=a.order&&(c=a.order);b&&b.data&&null!=b.data.order&&(e=b.data.order);b&&b.separator&&null!=b.order&&(e=b.order);return c-e});for(k in h){b=document.createElement("p");var l=
h[k];b.className="litemenu-entry "+(b.children?" submenu":"");var n=l.children&&l.children.length;n&&b.classList.add("has_submenu");l&&l.name?b.innerHTML="<span class='icon'></span><span class='name'>"+l.name+(n?"<span class='more'>+</span>":"")+"</span>":b.classList.add("separator");b.data=l;if(b.data.data){l=b.data.data;if("checkbox"==l.type&&l.instance&&l.property&&!0==l.instance[l.property]||!0==l.checkbox||l.instance&&l.property&&l.hasOwnProperty("value")&&l.instance[l.property]==l.value||"function"==
typeof l.isChecked&&l.isChecked.call(l.instance,l))b.className+=" checked";l.disabled&&(b.className+=" disabled")}b.addEventListener("click",function(){var b=this.data;if(b.data){if(b.data.disabled)return;b.data.instance&&b.data.property&&("checkbox"==b.data.type?(b.data.instance[b.data.property]=!b.data.instance[b.data.property],b.data.instance[b.data.property]?this.classList.add("checked"):this.classList.remove("checked")):b.data.hasOwnProperty("value")&&(b.data.instance[b.data.property]=b.data.value));
null!=b.data.checkbox&&(b.data.checkbox=!b.data.checkbox,b.data.checkbox?this.classList.add("checked"):this.classList.remove("checked"));b.data.callback&&"function"==typeof b.data.callback&&b.data.callback(b.data)}b.children&&b.children.length?f.showMenu(b,a,this,!0):(f.is_open=!1,f.hidePanels())});b.addEventListener("mouseenter",function(a){});g.appendChild(b)}g.addEventListener("mouseleave",function(a){f.closing_by_leave&&clearInterval(f.closing_by_leave);f.closing_by_leave=setTimeout(function(){f.is_open=
!1;f.hidePanels()},LiteGUI.Menubar.closing_time)});g.addEventListener("mouseenter",function(a){f.closing_by_leave&&clearInterval(f.closing_by_leave);f.closing_by_leave=null});c=c.getBoundingClientRect();g.style.left=c.left+(d?200:0)+"px";g.style.top=c.top+c.height+(d?-20:10)+"px";this.panels.push(g);document.body.appendChild(g)}};LiteGUI.Menubar=c})();
(function(){function c(b,a){function c(a){a.deltaY&&(g.scrollLeft+=a.deltaY)}this.options=a=a||{};var d=this.mode=a.mode||"horizontal",f=document.createElement("DIV");b&&(f.id=b);f.data=this;f.className="litetabs "+d;this.root=f;this.root.tabs=this;this.current_tab=null;"horizontal"==d?a.size&&(this.root.style.height="full"==a.size?"100%":a.size):"vertical"==d&&a.size&&(this.root.style.width="full"==a.size?"100%":a.size);a.width&&(this.root.style.width=a.width.constructor===Number?a.width.toFixed(0)+
"px":a.width);a.height&&(this.root.style.height=a.height.constructor===Number?a.height.toFixed(0)+"px":a.height);var g=document.createElement("UL");g.className="wtabcontainer";"vertical"==d?g.style.width=LiteGUI.Tabs.tabs_width+"px":g.style.height=LiteGUI.Tabs.tabs_height+"px";g.addEventListener("wheel",c);g.addEventListener("mousewheel",c);this.list=g;this.root.appendChild(this.list);this.tabs_root=g;this.tabs={};this.tabs_by_index=[];this.selected=null;this.onchange=a.callback;a.parent&&this.appendTo(a.parent)}
c.tabs_width=64;c.tabs_height=26;c.prototype.show=function(){this.root.style.display="block"};c.prototype.hide=function(){this.root.style.display="none"};c.prototype.getCurrentTab=function(){return this.current_tab?this.tabs[this.current_tab[0]]:null};c.prototype.getCurrentTabId=function(){return this.current_tab[0]};c.prototype.getPreviousTab=function(){return this.previous_tab?this.tabs[this.previous_tab[0]]:null};c.prototype.appendTo=function(b,a){a?$(b).prepend(this.root):$(b).append(this.root)};
c.prototype.getTab=function(b){return this.tabs[b]};c.prototype.getTabByIndex=function(b){return this.tabs_by_index[b]};c.prototype.getNumOfTabs=function(){var b=0,a;for(a in this.tabs)b++;return b};c.prototype.getTabContent=function(b){if(b=this.tabs[b])return b.content};c.prototype.getTabIndex=function(b){b=this.tabs[b];if(!b)return-1;for(var a=0;a<this.list.childNodes.length;a++)if(this.list.childNodes[a]==b.tab)return a;return-1};c.prototype.addTab=function(b,a,e){a=a||{};"function"==typeof a&&
(a={callback:a});var d=this;if(void 0===b||null===b)b="rand_"+(1E6*Math.random()|0);e=document.createElement("LI");var f=b.replace(/ /gi,"_");e.className="wtab wtab-"+f+" ";e.dataset.id=b;e.innerHTML="<span class='tabtitle'>"+(a.title||b)+"</span>";a.button&&(e.className+="button ");a.tab_className&&(e.className+=a.tab_className);a.bigicon&&(e.innerHTML="<img class='tabbigicon' src='"+a.bigicon+"'/>"+e.innerHTML);a.closable&&(e.innerHTML+="<span class='tabclose'>"+LiteGUI.special_codes.close+"</span>",
e.querySelector("span.tabclose").addEventListener("click",function(a){d.removeTab(b);a.preventDefault();a.stopPropagation()},!0));if(void 0!==a.index){var g=this.list.childNodes[a.index];g?this.list.insertBefore(e,g):this.list.appendChild(e)}else this.plus_tab?this.list.insertBefore(e,this.plus_tab):this.list.appendChild(e);a.tab_width&&(e.style.width=a.tab_width.constructor===Number?a.tab_width.toFixed(0)+"px":a.tab_width,e.style.minWidth="0");this.options.autoswitch&&(e.classList.add("autoswitch"),
e.addEventListener("dragenter",function(a){d._timeout_mouseover&&clearTimeout(d._timeout_mouseover);d._timeout_mouseover=setTimeout(function(){LiteGUI.trigger(this,"click");d._timeout_mouseover=null}.bind(this),1500)}),e.addEventListener("dragleave",function(a){d._timeout_mouseover&&(clearTimeout(d._timeout_mouseover),d._timeout_mouseover=null)}));g=document.createElement("div");a.id&&(g.id=a.id);g.className="wtabcontent wtabcontent-"+f+" "+(a.className||"");g.dataset.id=b;g.style.display="none";
"horizontal"==this.mode?a.size&&(g.style.overflow="auto","full"==a.size?(g.style.width="100%",g.style.height="calc( 100% - "+LiteGUI.Tabs.tabs_height+"px )",g.style.height="-moz-calc( 100% - "+LiteGUI.Tabs.tabs_height+"px )",g.style.height="-webkit-calc( 100% - "+LiteGUI.Tabs.tabs_height+"px )"):g.style.height=a.size):"vertical"==this.mode&&a.size&&(g.style.overflow="auto","full"==a.size?(g.style.height="100%",g.style.width="calc( 100% - "+LiteGUI.Tabs.tabs_width+"px )",g.style.width="-moz-calc( 100% - "+
LiteGUI.Tabs.tabs_width+"px )",g.style.width="-webkit-calc( 100% - "+LiteGUI.Tabs.tabs_width+"px )"):g.style.width=a.size);void 0!==a.width&&(g.style.width="string"===typeof a.width?a.width:a.width+"px");void 0!==a.height&&(g.style.height="string"===typeof a.height?a.height:a.height+"px");a.content&&("string"==typeof a.content?g.innerHTML=a.content:g.appendChild(a.content));this.root.appendChild(g);a.button?e.addEventListener("click",function(b){var c=this.dataset.id;a.callback&&a.callback(c,b)}):
e.addEventListener("click",c.prototype.onTabClicked);e.options=a;e.tabs=this;var f=e.querySelector("span.tabtitle"),h={id:b,tab:e,content:g,title:f,add:function(a){this.content.appendChild(a.root||a)},setTitle:function(a){this.title.innerHTML=a},click:function(){LiteGUI.trigger(this.tab,"click")},destroy:function(){d.removeTab(this.id)}};a.onclose&&(h.onclose=a.onclose);this.tabs[b]=h;this.recomputeTabsByIndex();e.addEventListener("contextmenu",function(b){if(2!=b.button)return!1;b.preventDefault();
a.callback_context&&a.callback_context.call(h);return!1}.bind(this));!0!=a.selected&&null!=this.selected||this.selectTab(b,a.skip_callbacks);return h};c.prototype.addPlusTab=function(b){this.plus_tab&&console.warn("There is already a plus tab created in this tab widget");this.plus_tab=this.addTab("plus_tab",{title:"+",tab_width:20,button:!0,callback:b,skip_callbacks:!0})};c.prototype.onTabClicked=function(b){if(!this.classList.contains("selected")&&this.parentNode){var a=this.options,c=this.parentNode.parentNode.tabs;
if(!c)throw"tabs not found";if(!a.callback_canopen||!1!=a.callback_canopen()){c.current_tab&&c.current_tab[0]!=d&&c.current_tab[2]&&c.current_tab[2].callback_leave&&c.current_tab[2].callback_leave(c.current_tab[0],c.current_tab[1],c.current_tab[2]);var d=this.dataset.id,f=null,g;for(g in c.tabs){var h=c.tabs[g];g==d?(h.selected=!0,h.content.style.display="",f=h.content):(delete h.selected,h.content.style.display="none")}$(c.list).find("li.wtab").removeClass("selected");this.classList.add("selected");
c.previous_tab=c.current_tab;c.current_tab=[d,f,a];if(b&&(a.callback&&a.callback(d,f,b),$(c).trigger("wchange",[d,f]),c.onchange))c.onchange(d,f);c.selected=d}}};c.prototype.selectTab=function(b,a){if(b){b.constructor!=String&&(b=b.id);for(var c=this.list.querySelectorAll("li.wtab"),d=0;d<c.length;d++)if(b==c[d].dataset.id){this.onTabClicked.call(c[d],!a);break}}};c.prototype.setTabVisibility=function(b,a){var c=this.tabs[b];c&&(c.tab.style.display=a?"none":null,c.content.style.display=a?"none":null)};
c.prototype.recomputeTabsByIndex=function(){this.tabs_by_index=[];for(var b in this.tabs){for(var a=this.tabs[b],c=0,d=a.tab;null!=(d=d.previousSibling);)c++;this.tabs_by_index[c]=a}};c.prototype.removeTab=function(b){var a=this.tabs[b];if(a){if(a.onclose)a.onclose(a);a.tab.parentNode.removeChild(a.tab);a.content.parentNode.removeChild(a.content);delete this.tabs[b];this.recomputeTabsByIndex()}};c.prototype.removeAllTabs=function(b){var a=[],c;for(c in this.tabs)a.push(this.tabs[c]);for(c in a){var d=
a[c];d==this.plus_tab&&b||(d.tab.parentNode.removeChild(d.tab),d.content.parentNode.removeChild(d.content),delete this.tabs[d.id])}this.recomputeTabsByIndex()};c.prototype.clear=function(){this.removeAllTabs()};c.prototype.hideTab=function(b){this.setTabVisibility(b,!1)};c.prototype.showTab=function(b){this.setTabVisibility(b,!0)};c.prototype.transferTab=function(b,a,c){var d=this.tabs[b];if(d){a.tabs[b]=d;void 0!==c?a.list.insertBefore(d.tab,a.list.childNodes[c]):a.list.appendChild(d.tab);a.root.appendChild(d.content);
delete this.tabs[b];c=null;for(var f in this.tabs){c=f;break}c&&this.selectTab(c);d.tab.classList.remove("selected");a.selectTab(b)}};c.prototype.detachTab=function(b,a,c){if(this.tabs[b]){var d=this.getTabIndex(b),f=window.open("","","width=800, height=600, location=no, status=no, menubar=no, titlebar=no, fullscreen=yes");f.document.write("<head><title>"+b+"</title>");for(var g=document.querySelectorAll("link[rel='stylesheet'],style"),h=0;h<g.length;h++)f.document.write(g[h].outerHTML);f.document.write("</head><body></body>");
f.document.close();var k=this,l=new LiteGUI.Tabs(null,this.options);f.tabs=l;f.onbeforeunload=function(){l.transferTab(b,k,d);c&&c()};l.list.style.height="20px";f.document.body.appendChild(l.root);k.transferTab(b,l);l.tabs[b].tab.classList.add("selected");this.recomputeTabsByIndex();a&&a();return f}};LiteGUI.Tabs=c})();
(function(){function c(b,a){function c(b){var e=[b.screenX-m.data[0],m.data[1]-b.screenY];m.data=[b.screenX,b.screenY];g(e[a.horizontal?0:1],b);b.stopPropagation();b.preventDefault();return!1}function d(a){document.activeElement===this&&(g(0<(void 0!==a.wheelDelta?a.wheelDelta:a.deltaY?-a.deltaY/3:0)?1:-1,a),a.stopPropagation(),a.preventDefault())}function f(a){LiteGUI.trigger(k,"stop_dragging");var b=q||document;q=null;b.removeEventListener("mousemove",c);b.removeEventListener("mouseup",f);LiteGUI.trigger(m,
"blur");a.stopPropagation();a.preventDefault();return!1}function g(b,c){a.linear||(b=0<b?Math.pow(b,1.2):-1*Math.pow(Math.abs(b),1.2));var e=a.step?a.step:1;c&&c.shiftKey?e*=10:c&&c.ctrlKey&&(e*=0.1);e=parseFloat(p.value)+b*e;null!=a.max&&e>a.max&&(e=a.max);null!=a.min&&e<a.min&&(e=a.min);p.value=e.toFixed(h);a.units&&(p.value+=a.units);LiteGUI.trigger(p,"change")}null===b||void 0===b?b=0:b.constructor===String?b=parseFloat(b):b.constructor!==Number&&(b=0);this.value=b;var h=void 0!=a.precision?a.precision:
3;this.options=a=a||{};var k=document.createElement("div");k.className="dragger "+(a.extraclass?a.extraclass:"");this.root=k;var l=document.createElement("span");l.className="inputfield "+(a.extraclass?a.extraclass:"")+(a.full?" full":"");a.disabled&&(l.className+=" disabled");k.appendChild(l);var n=a.dragger_class||"full",p=document.createElement("input");p.className="text number "+(n?n:"");p.value=b.toFixed(h)+(a.units?a.units:"");p.tabIndex=a.tab_index;this.input=p;k.input=p;a.disabled&&(p.disabled=
!0);a.tab_index&&(p.tabIndex=a.tab_index);l.appendChild(p);p.addEventListener("keydown",function(a){if(38==a.keyCode)g(1,a);else if(40==a.keyCode)g(-1,a);else return;a.stopPropagation();a.preventDefault();return!0});var m=document.createElement("div");m.className="drag_widget";a.disabled&&(m.className+=" disabled");l.appendChild(m);k.dragger=m;m.addEventListener("mousedown",function(b){q=p.ownerDocument;q.removeEventListener("mousemove",c);q.removeEventListener("mouseup",f);a.disabled||(q.addEventListener("mousemove",
c),q.addEventListener("mouseup",f),m.data=[b.screenX,b.screenY],LiteGUI.trigger(k,"start_dragging"));b.stopPropagation();b.preventDefault()});p.addEventListener("wheel",d,!1);p.addEventListener("mousewheel",d,!1);var q=null}c.prototype.setValue=function(b,a){this.value=b=parseFloat(b);this.options.precision&&(b=b.toFixed(this.options.precision));this.options.units&&(b+=this.options.units);this.input.value=b;a||LiteGUI.trigger(this.input,"change")};c.prototype.getValue=function(){return this.value};
LiteGUI.Dragger=c})();
(function(){function c(b,a,c){var d=document.createElement("div");this.root=d;b&&(d.id=b);d.className="litetree";this.tree=a;var f=this;this.options=c=c||{allow_rename:!1,allow_drag:!0,allow_multiselection:!1};this.indent_offset=c.indent_offset||0;c.height&&(this.root.style.height="string"==typeof c.height?c.height:Math.round(c.height)+"px");d.addEventListener("click",function(a){if(a.srcElement==f.root&&f.onBackgroundClicked)f.onBackgroundClicked(a,f)});d.addEventListener("contextmenu",function(a){if(2!=
a.button)return!1;if(f.onContextMenu)f.onContextMenu(a);a.preventDefault();return!1});b=this.createAndInsert(a,c,null);b.className+=" root_item";this.root_item=b}c.INDENT=20;c.prototype.updateTree=function(b){this.root.innerHTML="";(b=this.createAndInsert(b,this.options,null))?(b.className+=" root_item",this.root_item=b):this.root_item=null};c.prototype.insertItem=function(b,a,c,d){if(!a){var f=this.root.childNodes[0];f&&(a=f.dataset.item_id)}b=this.createAndInsert(b,d,a,c);a&&this._updateListBox(this._findElement(a));
return b};c.prototype.createAndInsert=function(b,a,c,d){var f=-1;c?f=this._findElementIndex(c):void 0===c&&(f=0);var g=null,h=0;-1!=f&&(g=this.root.childNodes[f],h=parseInt(g.dataset.level)+1);if(h=this.createTreeItem(b,a,h)){h.parent_id=c;this.getItem(h.dataset.item_id)&&console.warn("There another item with the same ID in this tree");-1==f?this.root.appendChild(h):this._insertInside(h,f,d);g&&!this._isNodeChildrenVisible(c)&&h.classList.add("hidden");if(b.children)for(c=0;c<b.children.length;++c)this.createAndInsert(b.children[c],
a,b.id);this._updateListBox(h,a);a&&a.selected&&this.markAsSelected(h,!0);return h}};c.prototype._insertInside=function(b,a,e,d){var f=this.root.childNodes[a];if(!f)throw"No parent node found, index: "+a+", nodes: "+this.root.childNodes.length;f=parseInt(f.dataset.level);d=void 0!==d?d:f+1;if(f=b.querySelector(".indentblock"))f.style.paddingLeft=(d+this.indent_offset)*c.INDENT+"px";b.dataset.level=d;for(a+=1;a<this.root.childNodes.length;++a)if(f=this.root.childNodes[a],f.classList&&f.classList.contains("ltreeitem")){var g=
parseInt(f.dataset.level);if(g==d&&e)e--;else if(g<d||0===e&&g===d){this.root.insertBefore(b,f);return}}this.root.appendChild(b)};c.prototype._isNodeChildrenVisible=function(b){b=this.getItem(b);return!b||b.classList.contains("hidden")?!1:(b=b.querySelector(".listbox"))?"closed"==b.getValue()?!1:!0:!0};c.prototype._findElement=function(b){if(!b||b.constructor!==String)throw"findElement param must be string with item id";for(var a=0;a<this.root.childNodes.length;++a){var c=this.root.childNodes[a];
if(c.classList&&c.classList.contains("ltreeitem")&&c.classList.contains("ltreeitem-"+b))return c}return null};c.prototype._findElementIndex=function(b){for(var a=0;a<this.root.childNodes.length;++a){var c=this.root.childNodes[a];if(c.classList&&c.classList.contains("ltreeitem"))if("string"===typeof b){if(c.dataset.item_id===b)return a}else if(c===b)return a}return-1};c.prototype._findElementLastChildIndex=function(b){var a=parseInt(this.root.childNodes[b].dataset.level);for(b+=1;b<this.root.childNodes.length;++b){var c=
this.root.childNodes[b];if(c.classList&&c.classList.contains("ltreeitem")&&parseInt(c.dataset.level)==a)return b}return-1};c.prototype._findChildElements=function(b,a){var c=this._findElementIndex(b);if(-1!=c){for(var d=parseInt(this.root.childNodes[c].dataset.level),f=[],c=c+1;c<this.root.childNodes.length;++c){var g=this.root.childNodes[c];if(g.classList&&g.classList.contains("ltreeitem")){var h=parseInt(g.dataset.level);if(!(a&&h>d+1)){if(h<=d)break;f.push(g)}}}return f}};c.prototype.createTreeItem=
function(b,a,c){function d(a){a.preventDefault();a.stopPropagation();if(!this.title_element._editing){if(a.ctrlKey&&h.options.allow_multiselection){if(h.isNodeSelected(this)){this.classList.remove("selected");LiteGUI.trigger(h.root,"item_remove_from_selection",{item:this,data:this.data});return}h.markAsSelected(this,!0);LiteGUI.trigger(h.root,"item_add_to_selection",{item:this,data:this.data});var c=!1;b.callback&&(c=b.callback.call(h,this));if(!c&&h.onItemAddToSelection)h.onItemAddToSelection(this.data,
this)}if(a.shiftKey&&h.options.allow_multiselection){if((c=h.getSelectedItem())&&c!==this){a=Array.prototype.slice.call(c.parentNode.children);var c=a.indexOf(c),e=a.indexOf(this);a=e>c?a.slice(c,e):a.slice(e,c);for(c=0;c<a.length;++c)e=a[c],h.markAsSelected(e,!0),LiteGUI.trigger(h.root,"item_add_to_selection",{item:e,data:e.data})}}else{h.markAsSelected(this);h._skip_scroll=!0;LiteGUI.trigger(h.root,"item_selected",{item:this,data:this.data});c=!1;b.callback&&(c=b.callback.call(h,this));if(!c&&h.onItemSelected)h.onItemSelected(this.data,
this);h._skip_scroll=!1}}}function f(a){var b=this,c=b.title_element.querySelector(".incontent");LiteGUI.trigger(h.root,"item_dblclicked",b);if(!c._editing&&h.options.allow_rename){c._editing=!0;c._old_name=c.innerHTML;c.innerHTML="<input type='text' value='"+c.innerHTML+"' />";var e=c.querySelector("input");$(e).blur(function(a){var e=a.target.value;setTimeout(function(){c.innerHTML=e},1);delete c._editing;LiteGUI.trigger(h.root,"item_renamed",{old_name:c._old_name,new_name:e,item:b,data:b.data});
delete c._old_name});e.addEventListener("keydown",function(a){13==a.keyCode&&$(this).blur()});$(e).focus();a.preventDefault()}a.preventDefault();a.stopPropagation()}function g(a){a.preventDefault()}if(null===b||void 0===b)console.error("Tree item cannot be null");else{a=document.createElement("li");a.className="ltreeitem";var h=this;if(b.id){var k=b.id.replace(/\s/g,"_");a.className+=" ltreeitem-"+k;a.dataset.item_id=b.id}if(b.dataset)for(var l in b.dataset)a.dataset[l]=b.dataset[l];b.DOM=a;a.data=
b;void 0!==c&&(a.dataset.level=c,a.classList.add("ltree-level-"+c));var n=document.createElement("div");n.className="ltreeitemtitle";b.className&&(n.className+=" "+b.className);n.innerHTML="<span class='precontent'></span><span class='indentblock'></span><span class='collapsebox'></span><span class='incontent'></span><span class='postcontent'></span>";c=b.content||b.id||"";n.querySelector(".incontent").innerHTML=c;b.precontent&&(n.querySelector(".precontent").innerHTML=b.precontent);if(b.dataset)for(l in b.dataset)a.dataset[l]=
b.dataset[l];a.appendChild(n);a.title_element=n;!1===b.visible&&(a.style.display="none");a.addEventListener("click",d);a.addEventListener("dblclick",f);a.addEventListener("contextmenu",function(a){a.preventDefault();a.stopPropagation();if(2==a.button)return h.onItemContextMenu?h.onItemContextMenu(a,{item:this,data:this.data}):!1});this.options.allow_drag&&(n.draggable=!0,n.addEventListener("dragstart",function(a){a.dataTransfer.setData("item_id",this.parentNode.dataset.item_id);if(b.onDragData){var c=
b.onDragData();if(c)for(var e in c)a.dataTransfer.setData(e,c[e])}}));var p=0;n.addEventListener("dragenter",function(a){a.preventDefault();if(b.skipdrag)return!1;0==p&&n.classList.add("dragover");p++});n.addEventListener("dragleave",function(a){a.preventDefault();p--;0==p&&n.classList.remove("dragover")});n.addEventListener("dragover",g);n.addEventListener("drop",function(a){n.classList.remove("dragover");a.preventDefault();if(b.skipdrag)return!1;var c=a.dataTransfer.getData("item_id");if(c){var e=
this.parentNode.dataset.item_id;(!h.onMoveItem||h.onMoveItem&&!1!=h.onMoveItem(h.getItem(c),h.getItem(e)))&&h.moveItem(c,e)&&LiteGUI.trigger(h.root,"item_moved",{item:h.getItem(c),parent_item:h.getItem(e)})}else LiteGUI.trigger(h.root,"drop_on_item",{item:this,event:a});if(h.onDropItem)h.onDropItem(a,this.parentNode.data)});return a}};c.prototype.filterByName=function(b){for(var a=0;a<this.root.childNodes.length;++a){var e=this.root.childNodes[a];if(e.classList&&e.classList.contains("ltreeitem")){var d=
e.querySelector(".incontent");if(d)if(d=d.innerHTML.toLowerCase(),b&&-1==d.indexOf(b.toLowerCase()))e.classList.add("filtered");else if(e.data&&!1!==e.data.visible&&e.classList.remove("filtered"),d=e.querySelector(".indentblock"))d.style.paddingLeft=b?0:paddingLeft=(parseInt(e.dataset.level)+this.indent_offset)*c.INDENT+"px"}}};c.prototype.filterByRule=function(b,a){if(!b)throw"filterByRule requires a callback";for(var c=0;c<this.root.childNodes.length;++c){var d=this.root.childNodes[c];if(d.classList&&
d.classList.contains("ltreeitem")){var f=d.querySelector(".incontent");if(f)if(b(d.data,f,a)){if(d.data&&!1!==d.data.visible&&d.classList.remove("filtered"),f=d.querySelector(".indentblock"))f.style.paddingLeft=name?0:paddingLeft=(parseInt(d.dataset.level)+this.indent_offset)*LiteGUI.Tree.INDENT+"px"}else d.classList.add("filtered")}}};c.prototype.getItem=function(b){if(!b)return null;if(b.classList)return b;for(var a=0;a<this.root.childNodes.length;++a){var c=this.root.childNodes[a];if(c.classList&&
c.classList.contains("ltreeitem")&&c.dataset.item_id===b)return c}return null};c.prototype.expandItem=function(b){(b=this.getItem(b))&&b.listbox&&listbox.setValue(!0)};c.prototype.collapseItem=function(b){(b=this.getItem(b))&&b.listbox&&listbox.setValue(!1)};c.prototype.isInsideArea=function(b){b=b.constructor===String?this.getItem(b):b;if(!b)return!1;var a=this.root.getClientRects();if(!a.length)return!1;a=a[0].height;b=b.offsetTop;return this.root.scrollTop<b&&b<this.root.scrollTop+a?!0:!1};c.prototype.scrollToItem=
function(b){if(b=b.constructor===String?this.getItem(b):b){var a=this.root.getClientRects();if(!a.length)return!1;var a=a[0],e=a.height,d=(parseInt(b.dataset.level)+this.indent_offset)*c.INDENT+50;this.root.scrollTop=b.offsetTop-0.5*e|0;this.root.scrollLeft=0.75*a.width<d?d:0}};c.prototype.setSelectedItem=function(b,a,c){if(b){b=this.getItem(b);if(!b)return null;if(!b.classList.contains("selected"))return this.markAsSelected(b),a&&!this._skip_scroll&&this.scrollToItem(b),c&&LiteGUI.trigger(b,"click"),
b}else this.unmarkAllAsSelected()};c.prototype.addItemToSelection=function(b){if(b){b=this.getItem(b);if(!b)return null;this.markAsSelected(b,!0);return b}};c.prototype.removeItemFromSelection=function(b){if(b){b=this.getItem(b);if(!b)return null;b.classList.remove("selected")}};c.prototype.getSelectedItem=function(){return this.root.querySelector(".ltreeitem.selected")};c.prototype.getSelectedItems=function(){return this.root.querySelectorAll(".ltreeitem.selected")};c.prototype.isItemSelected=function(b){return(b=
this.getItem(b))?this.isNodeSelected(b):!1};c.prototype.getChildren=function(b,a){b&&b.constructor!==String&&b.dataset&&(b=b.dataset.item_id);return this._findChildElements(b,a)};c.prototype.getParent=function(b){return(b=this.getItem(b))?this.getItem(b.parent_id):null};c.prototype.moveItem=function(b,a){if(b===a)return!1;var c=this.getItem(b),d=this.getItem(a),f=this._findElementIndex(d),g=parseInt(d.dataset.level),h=this.getParent(c);if(!h)return console.error("node parent not found by id, maybe id has changed"),
!1;var k=parseInt(h.dataset.level),f=g-k;if(!d||!c||d==h)return!1;c.parent_id=a;if(g=this.getChildren(c)){g.unshift(c);for(c=0;c<g.length;c++)g[c].parentNode.removeChild(g[c]);for(c=0;c<g.length;c++){var k=g[c],l=parseInt(k.dataset.level)+f;k.dataset.level=l}f=this._findElementIndex(d);l=this._findElementLastChildIndex(f);-1==l&&(l=0);for(c=0;c<g.length;c++)k=g[c],this._insertInside(k,f,l+c-1,parseInt(k.dataset.level))}this._updateListBox(d);h&&this._updateListBox(h);return!0};c.prototype.removeItem=
function(b,a){var c=b;"string"==typeof b&&(c=this.getItem(b));if(!c)return!1;var d=this.getParent(c),f=null;a&&(f=this.getChildren(c));this.root.removeChild(c);if(f)for(c=0;c<f.length;c++)this.root.removeChild(f[c]);d&&this._updateListBox(d);return!0};c.prototype.updateItem=function(b,a){var c=this.getItem(b);if(!c)return!1;c.data=a;a.id&&(c.id=a.id);a.content&&(c.title_element.querySelector(".incontent").innerHTML=a.content);return!0};c.prototype.updateItemId=function(b,a){var c=this.getItem(b);
if(!c)return!1;var d=this.getChildren(b,!0);c.id=a;for(c=0;c<d.length;++c)d[c].parent_id=a;return!0};c.prototype.clear=function(b){if(b){b=this.root.querySelectorAll(".ltreeitem");for(var a=1;a<b.length;a++)this.root.removeChild(b[a])}else this.root.innerHTML=""};c.prototype.getNodeByIndex=function(b){return this.root.querySelectorAll(".ltreeitem")[b]};c.prototype.unmarkAllAsSelected=function(){this.root.classList.remove("selected");var b=this.root.querySelectorAll(".ltreeitem.selected");if(b)for(var a=
0;a<b.length;a++)b[a].classList.remove("selected");b=this.root.querySelectorAll(".ltreeitem.semiselected");for(a=0;a<b.length;a++)b[a].classList.remove("semiselected")};c.prototype.isNodeSelected=function(b){return b.classList.contains("selected")?!0:!1};c.prototype.markAsSelected=function(b,a){if(!b.classList.contains("selected")){a||this.unmarkAllAsSelected();b.classList.add("selected");for(var c=this.getParent(b);c;)c.classList.add("semiselected"),c=this.getParent(c)}};c.prototype._updateListBox=
function(b,a){if(b){var c=this;if(!b.listbox){var d=b.title_element.querySelector(".collapsebox"),f=LiteGUI.createLitebox(!0,function(a){c.onClickBox(a,b);LiteGUI.trigger(c.root,"item_collapse_change",{item:b,data:f.getValue()})});f.stopPropagation=!0;f.setEmpty(!0);d.appendChild(f);b.listbox=f}a&&a.collapsed&&b.listbox.collapse();(d=this.getChildren(b.dataset.item_id))&&(d.length?b.listbox.setEmpty(!1):b.listbox.setEmpty(!0))}};c.prototype.onClickBox=function(b,a){var c=this.getChildren(a);if(c)for(var d=
0;d<c.length;++d){var f=c[d],g=this.getParent(f),h=!0;g&&(h=this._isNodeChildrenVisible(g));h?f.classList.remove("hidden"):f.classList.add("hidden")}};LiteGUI.Tree=c})();
(function(){function c(b,a){this._ctor(b,a)}c.title_height="20px";c.prototype._ctor=function(b,a){!a&&b&&b.constructor!==String&&(a=b,b=null);a=a||{};this.content=a.content||"";var c=this.root=document.createElement("div");b&&(c.id=b);c.className="litepanel "+(a.className||"");c.data=this;var d="";a.title&&(d+="<div class='panel-header'>"+a.title+"</div>");d+="<div class='content'>"+this.content+"</div>";c.innerHTML=d+"<div class='panel-footer'></div>";a.title&&(this.header=this.root.querySelector(".panel-header"));
this.content=this.root.querySelector(".content");this.footer=this.root.querySelector(".panel-footer");!0==a.scroll&&(this.content.style.overflow="auto")};c.prototype.add=function(b){this.content.appendChild(b.root)};LiteGUI.Panel=c})();
(function(){function c(b,a){this._ctor(b,a)}c.MINIMIZED_WIDTH=200;c.title_height="20px";c.getDialog=function(b){return(b=document.getElementById(b))?b.dialog:null};c.prototype._ctor=function(b,a){!a&&b&&b.constructor!==String&&(a=b,b=null);var e=this;this.width=a.width;this.height=a.height;this.minWidth=a.minWidth||150;this.minHeight=a.minHeight||100;this.content=a.content||"";var d=document.createElement("div");b&&(d.id=b);d.className="litedialog "+(a.className||"");d.data=this;d.dialog=this;var f=
"";if(a.title){f+="<div class='panel-header'>"+a.title+"</div><div class='buttons'>";a.minimize&&(f+="<button class='litebutton mini-button minimize-button'>-</button><button class='litebutton mini-button maximize-button' style='display:none'></button>");a.hide&&(f+="<button class='litebutton mini-button hide-button'></button>");a.detachable&&(f+="<button class='litebutton mini-button detach-button'></button>");if(a.close||a.closable)f+="<button class='litebutton mini-button close-button'>"+LiteGUI.special_codes.close+
"</button>";f+="</div>"}f+="<div class='content'>"+this.content+"</div>";f+="<div class='panel-footer'></div>";d.innerHTML=f;this.root=d;this.content=d.querySelector(".content");this.footer=d.querySelector(".panel-footer");a.fullcontent&&(this.content.style.width="100%",this.content.style.height=a.title?"calc( 100% - "+c.title_height+" )":"100%");if(a.buttons)for(var g in a.buttons)this.addButton(a.buttons[g].name,a.buttons[g]);!0==a.scroll&&(this.content.style.overflow="auto");(f=d.querySelector(".close-button"))&&
f.addEventListener("click",this.close.bind(this));(f=d.querySelector(".maximize-button"))&&f.addEventListener("click",this.maximize.bind(this));(f=d.querySelector(".minimize-button"))&&f.addEventListener("click",this.minimize.bind(this));(f=d.querySelector(".hide-button"))&&f.addEventListener("click",this.hide.bind(this));(d=d.querySelector(".detach-button"))&&d.addEventListener("click",function(){e.detachWindow()});this.enableProperties(a);this.root.addEventListener("DOMNodeInsertedIntoDocument",
function(){if(e.on_attached_to_DOM)e.on_attached_to_DOM();if(e.on_resize)e.on_resize()});this.root.addEventListener("DOMNodeRemovedFromDocument",function(){if(e.on_detached_from_DOM)e.on_detached_from_DOM()});if(a.attach||a.parent)d=null,a.parent&&(d="string"==typeof a.parent?document.querySelector(a.parent):a.parent),d||(d=LiteGUI.root),d.appendChild(this.root),this.center()};c.prototype.add=function(b){this.content.appendChild(b.root||b)};c.prototype.enableProperties=function(b){b=b||{};var a=this,
c=this.root;c.style.position="absolute";c.style.minWidth=this.minWidth+"px";c.style.minHeight=this.minHeight+"px";this.width&&(c.style.width=this.width+"px");this.height&&("number"==typeof this.height?c.style.height=this.height+"px":-1!=this.height.indexOf("%")&&(c.style.height=this.height),this.content.style.height="calc( "+this.height+"px - 24px )");c.style.boxShadow="0 0 3px black";b.draggable&&(this.draggable=!0,LiteGUI.draggable(c,c.querySelector(".panel-header"),function(){a.bringToFront()},
null,function(){return!a.minimized}));b.resizable&&this.setResizable()};c.prototype.setResizable=function(){function b(c){if("mousedown"==c.type)document.body.addEventListener("mousemove",b),document.body.addEventListener("mouseup",b),h=this==d,f[0]=c.pageX,f[1]=c.pageY;else if("mousemove"==c.type){var e=LiteGUI.getRect(a),n=e.width,p=n-(f[0]-c.pageX),e=e.height,m=e-(f[1]-c.pageY);h&&(a.style.width=p+"px");a.style.height=m+"px";f[0]=c.pageX;f[1]=c.pageY;g.content.style.height="calc( 100% - 24px )";
if(g.on_resize&&(n!=p||e!=m))g.on_resize(c,p,m)}else"mouseup"==c.type&&(document.body.removeEventListener("mousemove",b),document.body.removeEventListener("mouseup",b),h=!1);c.preventDefault();c.stopPropagation();return!1}if(!this.resizable){var a=this.root;this.resizable=!0;var c=this.footer;c.style.minHeight="4px";c.classList.add("resizable");var d=document.createElement("div");d.className="resizable-corner";this.root.appendChild(d);c.addEventListener("mousedown",b);d.addEventListener("mousedown",
b,!0);var f=[0,0],g=this,h=!1}};c.prototype.dockTo=function(b,a){if(b){var c=this.root;a=a||"full";b=b.content||b;c.style.top=0;c.style.left=0;c.style.boxShadow="0 0 0";if("full"==a)c.style.position="relative",c.style.width="100%",c.style.height="100%",this.content.style.width="100%",this.content.style.height="calc(100% - "+LiteGUI.Panel.title_height+")",this.content.style.height="-moz-calc(100% - "+LiteGUI.Panel.title_height+")",this.content.style.height="-webkit-calc(100% - "+LiteGUI.Panel.title_height+
")",this.content.style.overflow="auto";else if("left"==a||"right"==a)c.style.position="absolute",c.style.top=0,c.style[a]=0,c.style.width=this.width+"px",c.style.height="100%",this.content.style.height="-moz-calc(100% - "+LiteGUI.Panel.title_height+")",this.content.style.height="-webkit-calc(100% - "+LiteGUI.Panel.title_height+")",this.content.style.height="calc(100% - "+LiteGUI.Panel.title_height+")",this.content.style.overflow="auto","right"==a&&(c.style.left="auto",c.style.right=0);else if("bottom"==
a||"top"==a)c.style.width="100%",c.style.height=this.height+"px","bottom"==a&&(c.style.bottom=0,c.style.top="auto");this.draggable&&LiteGUI.draggable(c);b.content?b.content.appendChild(c):"string"==typeof b?(b=document.querySelector(b))&&b.appendChild(c):b.appendChild(c)}};c.prototype.addButton=function(b,a){a=a||{};a.constructor===Function&&(a={callback:a});var c=this,d=document.createElement("button");d.className="litebutton";d.innerHTML=b;a.className&&(d.className+=" "+a.className);this.root.querySelector(".panel-footer").appendChild(d);
d.addEventListener("click",function(b){a.callback&&a.callback(this);a.close&&c.close()});return d};c.prototype.close=function(){LiteGUI.remove(this.root);LiteGUI.trigger(this,"closed",this);if(this.on_close)this.on_close();this.onclose&&console.warn("Dialog: Do not use onclose, use on_close instead");this.dialog_window&&(this.dialog_window.close(),this.dialog_window=null)};c.prototype.highlight=function(b){b=b||100;this.root.style.outline="1px solid white";var a=this.root.ownerDocument;(a.defaultView||
a.parentWindow).focus();setTimeout(function(){this.root.style.outline=null}.bind(this),b)};c.minimized=[];c.prototype.minimize=function(){if(!this.minimized){this.minimized=!0;this.old_box=this.root.getBoundingClientRect();this.root.querySelector(".content").style.display="none";var b=this.root.querySelector(".minimize-button");b&&(b.style.display="none");if(b=this.root.querySelector(".maximize-button"))b.style.display="";this.root.style.width=LiteGUI.Dialog.MINIMIZED_WIDTH+"px";LiteGUI.bind(this,
"closed",function(){LiteGUI.Dialog.minimized.splice(LiteGUI.Dialog.minimized.indexOf(this),1);LiteGUI.Dialog.arrangeMinimized()});LiteGUI.Dialog.minimized.push(this);LiteGUI.Dialog.arrangeMinimized();LiteGUI.trigger(this,"minimizing")}};c.arrangeMinimized=function(){for(var b in LiteGUI.Dialog.minimized){var a=LiteGUI.Dialog.minimized[b],c=a.root.parentNode.getBoundingClientRect().height-20;a.root.style.left=LiteGUI.Dialog.MINIMIZED_WIDTH*b;a.root.style.top=c+"px"}};c.prototype.maximize=function(){if(this.minimized){this.minimized=
!1;this.root.querySelector(".content").style.display="";LiteGUI.draggable(this.root);this.root.style.left=this.old_box.left+"px";this.root.style.top=this.old_box.top+"px";this.root.style.width=this.old_box.width+"px";this.root.style.height=this.old_box.height+"px";var b=this.root.querySelector(".minimize-button");b&&(b.style.display="");if(b=this.root.querySelector(".maximize-button"))b.style.display="none";LiteGUI.Dialog.minimized.splice(LiteGUI.Dialog.minimized.indexOf(this),1);LiteGUI.Dialog.arrangeMinimized();
LiteGUI.trigger(this,"maximizing")}};c.prototype.makeModal=function(){LiteGUI.showModalBackground(!0);LiteGUI.modalbg_div.appendChild(this.root);this.show();this.center();LiteGUI.bind(this,"closed",function(b){LiteGUI.showModalBackground(!1)})};c.prototype.bringToFront=function(){var b=this.root.parentNode;b.removeChild(this.root);b.appendChild(this.root)};c.prototype.show=function(b,a){if(!this.root.parentNode){if(a){var c=a.ownerDocument;(c.querySelector(".litegui-wrap")||c.body).appendChild(this.root);
(c.defaultView||c.parentWindow).focus()}else LiteGUI.add(this);this.center()}this.detach_window||(this.root.style.display="",LiteGUI.trigger(this,"shown"))};c.prototype.hide=function(b){this.root.style.display="none";LiteGUI.trigger(this,"hidden")};c.prototype.fadeIn=function(b){b=b||1E3;this.root.style.display="";this.root.style.opacity=0;var a=this;setTimeout(function(){a.root.style.transition="opacity "+b+"ms";a.root.style.opacity=1},100)};c.prototype.setPosition=function(b,a){this.root.parentNode||
console.warn("LiteGUI.Dialog: Cannot set position of dialog if it is not in the DOM");this.root.position="absolute";this.root.style.left=b+"px";this.root.style.top=a+"px"};c.prototype.setSize=function(b,a){this.root.style.width="number"==typeof b?b+"px":b;this.root.style.height="number"==typeof a?a+"px":a};c.prototype.setTitle=function(b){this.header&&(this.header.innerHTML=b)};c.prototype.center=function(){if(this.root.parentNode){this.root.position="absolute";var b=this.root.offsetHeight,a=this.root.parentNode.offsetHeight;
this.root.style.left=Math.floor(0.5*(this.root.parentNode.offsetWidth-this.root.offsetWidth))+"px";this.root.style.top=Math.floor(0.5*(a-b))+"px"}};c.prototype.adjustSize=function(b,a){b=b||0;this.content.style.height="auto";if(0!=this.content.offsetHeight||a)this.setSize(this.content.offsetWidth,this.content.offsetHeight+20+b);else{var c=this;setTimeout(function(){c.adjustSize(b,!0)},1)}};c.prototype.clear=function(){this.content.innerHTML=""};c.prototype.detachWindow=function(b,a){if(!this.dialog_window){var c=
this.root.getClientRects()[0],d=c.width,c=c.height,f="Window",g=this.root.querySelector(".panel-header");g&&(f=g.textContent);var h=window.open("","","width="+d+", height="+c+", location=no, status=no, menubar=no, titlebar=no, fullscreen=yes");h.document.write("<head><title>"+f+"</title>");this.dialog_window=h;d=document.querySelectorAll("link[rel='stylesheet'],style");for(c=0;c<d.length;c++)h.document.write(d[c].outerHTML);h.document.write("</head><body></body>");h.document.close();h.onbeforeunload=
function(){var b=LiteGUI.windows.indexOf(h);-1!=b&&LiteGUI.windows.splice(b,1);a&&a()};h.document.body.appendChild(this.content);this.root.style.display="none";this._old_height=this.content.style.height;this.content.style.height="100%";LiteGUI.windows.push(h);b&&b();return h}};c.prototype.reattachWindow=function(b){this.dialog_window&&(this.root.appendChild(this.content),this.root.style.display="",this.content.style.height=this._old_height,delete this._old_height,this.dialog_window.close(),b=LiteGUI.windows.indexOf(this.dialog_window),
-1!=b&&LiteGUI.windows.splice(b,1),this.dialog_window=null)};c.showAll=function(){for(var b=document.body.querySelectorAll("litedialog"),a=0;a<b.length;a++)b[a].dialog.show()};c.hideAll=function(){for(var b=document.body.querySelectorAll("litedialog"),a=0;a<b.length;a++)b[a].dialog.hide()};c.closeAll=function(){for(var b=document.body.querySelectorAll("litedialog"),a=0;a<b.length;a++)b[a].dialog.close()};LiteGUI.Dialog=c})();
(function(){function c(b){b=b||{};this.root=document.createElement("table");this.root.classList.add("litetable");this.columns=[];this.column_fields=[];this.rows=[];this.data=[];this._must_update_header=!0;b.colums&&this.setColumns(b.colums);b.scrollable&&(this.root.style.overflow="auto");b.height&&(this.root.style.height=LiteGUI.sizeToCSS(b.height));b.columns&&this.setColumns(b.columns);b.rows&&this.setRows(b.data)}c.prototype.setRows=function(b,a){this.data=b;this.updateContent(a)};c.prototype.addRow=
function(b,a){for(var c=document.createElement("tr"),d=0;d<this.column_fields.length;++d){var f=document.createElement("td"),g=null,g=b.constructor===Array?b[d]:b[this.column_fields[d]];void 0===g&&(g="");f.innerHTML=g;g=this.columns[d];if(void 0===g)break;g.className&&(f.className=g.className);g.width&&(f.style.width=g.width);c.appendChild(f)}this.root.appendChild(c);this.rows.push(c);a||this.data.push(b);return c};c.prototype.updateRow=function(b,a){this.data[b]=a;var c=this.rows[b];if(c){for(var d=
c.querySelectorAll("td"),f=0;f<d.length;++f){var g=this.columns[f],h=null,h=a.constructor===Array?a[f]:a[g.field];void 0===h&&(h="");d[f].innerHTML=h}return c}};c.prototype.updateCell=function(b,a,c){if(b=this.rows[b])if(a=b.childNodes[a])return a.innerHTML=c,a};c.prototype.setColumns=function(b){this.columns.length=0;this.column_fields.length=0;for(var a=Math.floor(100/b.length).toFixed(1)+"%",c=[],d=0;d<b.length;++d){var f=b[d];if(null!==f&&void 0!==f){if(f.constructor===String||f.constructor===
Number)f={name:String(f)};f={name:f.name||"",width:LiteGUI.sizeToCSS(f.width||a),field:(f.field||f.name||"").toLowerCase(),className:f.className};d==b.length-1?f.width=" calc( 100% - ( "+c.join(" + ")+" ) )":c.push(f.width);this.columns.push(f);this.column_fields.push(f.field)}}this._must_update_header=!0;this.updateContent()};c.prototype.updateContent=function(b){this.root.innerHTML="";if(this._must_update_header){this.header=document.createElement("tr");for(var a=0;a<this.columns.length;++a){var c=
this.columns[a],d=document.createElement("th");d.innerHTML=c.name;c.width&&(d.style.width=c.width);c.th=d;this.header.appendChild(d)}this._must_update_header=!1}this.root.appendChild(this.header);if(this.data)if(this.data.length!=this.rows.length&&(b=!1),b)for(a=0;a<this.rows.length;++a)b=this.updateRow(a,this.data[a]),this.root.appendChild(b);else for(a=this.rows.length=0;a<this.data.length;++a)this.addRow(this.data[a],!0)};LiteGUI.Table=c})();
this.jQuery&&(jQuery.fn.wchange=function(c){$(this[0]).on("wchange",c)},jQuery.fn.wclick=function(c){$(this[0]).on("wclick",c)});
function Inspector(c,b){c&&c.constructor===Object&&!b&&(b=c,c=null);b=b||{};this.root=document.createElement("DIV");this.root.className="inspector "+(b.full?"full":"");b.one_line&&(this.one_line=!0,this.root.className+=" one_line");c&&(this.root.id=c);this.sections=[];this.values={};this.widgets=[];this.widgets_by_name={};this.row_number=0;this.addContainer();this.tab_index=Math.floor(1E4*Math.random());b.width&&(this.root.style.width=LiteGUI.sizeToCSS(b.width));b.height&&(this.root.style.height=
LiteGUI.sizeToCSS(b.height),b.one_line||(this.root.style.overflow="auto"));b.name_width&&(this.name_width=b.name_width);b.widgets_width&&(this.widgets_width=b.widgets_width);b.onchange&&(this.onchange=b.onchange);b.parent&&this.appendTo(b.parent);this.widgets_per_row=b.widgets_per_row||1}Inspector.prototype.appendTo=function(c,b){b?c.insertBefore(this.root,c.firstChild):c.appendChild(this.root)};
Inspector.prototype.clear=function(){for(purgeElement(this.root,!0);this.root.hasChildNodes();)this.root.removeChild(this.root.lastChild);this.row_number=0;this.values={};this.widgets=[];this.widgets_by_name={};this.sections=[];this._current_container_stack=this._current_container=this.current_section=null;this.addContainer()};Inspector.prototype.refresh=function(){if(this.on_refresh)this.on_refresh()};
Inspector.prototype.append=function(c,b){b=b||{};var a=b.widget_parent||this._current_container||this.root;b.replace?b.replace.parentNode.replaceChild(c,b.replace):(c.section=this.current_section,a.appendChild(c))};Inspector.prototype.pushContainer=function(c){if(this._current_container_stack){if(-1!=this._current_container_stack.indexOf(c)){console.warn("Container already in the stack");return}this._current_container_stack.push(c)}else this._current_container_stack=[c];this._current_container=c};
Inspector.prototype.isContainerInStack=function(c){return this._current_container_stack?-1!=this._current_container_stack.indexOf(c)?!0:!1:!1};
Inspector.prototype.popContainer=function(c){this.row_number=0;if(this._current_container_stack&&this._current_container_stack.length){if(c)for(var b=this._current_container_stack.pop();b&&b!=c;)b=this._current_container_stack.pop();else this._current_container_stack.pop();this._current_container=this._current_container_stack[this._current_container_stack.length-1]}else this._current_container=null};Inspector.prototype.setup=function(c){for(var b in c){var a=c[b];this.add(a.type,a.name,a.value,a.options)}};
Inspector.prototype.getWidget=function(c){return null!==c&&c.constructor===Number?this.widgets[c]:this.widgets_by_name[c]};
Inspector.prototype.inspectInstance=function(c,b,a,e){function d(a,b){b=b||{};for(var c in a)b[c]=a[c];return b}if(c){b||(b=c.getProperties?c.getProperties():this.collectProperties(c));var f=c.constructor;!a&&f.properties&&(a=f.properties);var g={};if(c.getInspectorProperties)g=c.getInspectorProperties();else for(var h in b)if(a&&a[h])g[h]=d(a[h]);else{var k=b[h];if(f["@"+h])(k=f["@"+h])&&null===k.widget||(g[h]=d(k));else if(c["@"+h])g[h]=c["@"+h];else if(null!==k&&void 0!==k)switch(k.constructor){case Number:g[h]=
{type:"number",step:0.1};break;case String:g[h]={type:"string"};break;case Boolean:g[h]={type:"boolean"};break;default:if(k&&k.length)switch(k.length){case 2:g[h]={type:"vec2",step:0.1};break;case 3:g[h]={type:"vec3",step:0.1};break;case 4:g[h]={type:"vec4",step:0.1}}}}if(e)for(h in e)delete g[e[h]];return this.showProperties(c,g)}};
Inspector.prototype.collectProperties=function(c){var b={},a;for(a in c)if("_"!=a[0]&&"@"!=a[0]&&"jQuery"!=a.substr(0,6)){var e=c[a];if(!e||e.constructor!=Function||c.constructor["@"+a])b[a]=e}return b};
Inspector.prototype.showProperties=function(c,b){for(var a in b){var e=a,d=b[a];if(d){d.constructor===String&&(d={type:d});d.name&&(e=d.name);if(!d.callback){var f={instance:c,name:e,options:d};d.callback=Inspector.assignValue.bind(f)}d.callback_update||(f={instance:c,name:e},d.callback_update=function(){return this.instance[this.name]}.bind(f));d.instance=c;d.varname=e;f=d.widget||d.type||"string";if(this.on_addProperty)this.on_addProperty(f,c,e,c[e],d);this.add(f,e,c[e],d)}}if(c.constructor.widgets)for(a in c.constructor.widgets)e=
c.constructor.widgets[a],this.add(e.widget,e.name,e.value,e);if(c.onShowProperties)c.onShowProperties(this);if(c.constructor.onShowProperties)c.constructor.onShowProperties(c,this)};
Inspector.assignValue=function(c){var b=this.instance,a=b[this.name];if(null==a||null==c||"enum"==this.options.type)b[this.name]=c;else if("number"==typeof a)b[this.name]=parseFloat(c);else if("string"==typeof a)b[this.name]=c;else if(c&&c.length&&a&&a.length&&!(Object.getOwnPropertyDescriptor(b,this.name)&&Object.getOwnPropertyDescriptor(b,this.name).set||Object.getOwnPropertyDescriptor(b.__proto__,this.name)&&Object.getOwnPropertyDescriptor(b.__proto__,this.name).set))for(b=0;b<c.length;++b)a[b]=
c[b];else b[this.name]=c};
Inspector.prototype.createWidget=function(c,b,a){a=a||{};b=void 0===b||null===b?"":b;var e=document.createElement("DIV");e.className="widget "+(a.className||"");e.inspector=this;e.options=a;e.name=c;this.row_number+=this.widgets_per_row;0==this.row_number%2&&(e.className+=" even");var d=a.width||this.widgets_width;d&&(e.style.width=LiteGUI.sizeToCSS(d),e.style.minWidth="auto");if(d=a.height||this.height)e.style.height=LiteGUI.sizeToCSS(d),e.style.minHeight="auto";this.widgets.push(e);c&&(this.widgets_by_name[c]=
e);1!=this.widgets_per_row&&(a.width||(e.style.width=(100/this.widgets_per_row).toFixed(2)+"%"),e.style.display="inline-block");var f=d="";void 0===c||null===c||!this.name_width&&!a.name_width||this.one_line||(f=LiteGUI.sizeToCSS(a.name_width||this.name_width),d="style='width: calc("+f+" - 0px); width: -webkit-calc("+f+" - 0px); width: -moz-calc("+f+" - 0px); '",f="style='width: calc( 100% - "+f+"); width: -webkit-calc(100% - "+f+"); width: -moz-calc( 100% - "+f+"); '");a.name_width&&(d="style='width: "+
LiteGUI.sizeToCSS(a.name_width)+" '");a.content_width&&(f="style='width: "+LiteGUI.sizeToCSS(a.content_width)+" '");var g="",h="",k=this.one_line?"":"<span class='filling'></span>";a.pretitle&&(h=a.pretitle);var l="wcontent ",n=c;a.title&&(n=a.title);null===c||void 0===c?l+=" full":g=""===c?g+("<span class='wname' title='"+n+"' "+d+">"+h+"</span>"):g+("<span class='wname' title='"+n+"' "+d+">"+h+c+k+"</span>");b.constructor===String||b.constructor===Number||b.constructor===Boolean?e.innerHTML=g+"<span class='info_content "+
l+"' "+f+">"+b+"</span>":(e.innerHTML=g+"<span class='info_content "+l+"' "+f+"></span>",(c=e.querySelector("span.info_content"))&&c.appendChild(b));e.content=e.querySelector("span.info_content");e.remove=function(){this.parentNode&&this.parentNode.removeChild(this)};return e};
Inspector.onWidgetChange=function(c,b,a,e,d,f){var g=c.section;e.skip_wchange||(g&&LiteGUI.trigger(g,"wbeforechange",a),LiteGUI.trigger(c,"wbeforechange",a));this.values[b]=a;var h=void 0;e.callback&&(h=d?e.callback.apply(c,a):e.callback.call(c,a,f));e.skip_wchange||(g&&LiteGUI.trigger(g,"wchange",a),LiteGUI.trigger(c,"wchange",a));if(this.onchange)this.onchange(b,a,c);return h};
Inspector.widget_constructors={"null":"addNull",title:"addTitle",info:"addInfo","default":"addDefault",number:"addNumber",slider:"addSlider",string:"addString",text:"addString",textarea:"addTextarea",color:"addColor","boolean":"addCheckbox",checkbox:"addCheckbox",icon:"addIcon",vec2:"addVector2",vector2:"addVector2",vec3:"addVector3",vector3:"addVector3",vec4:"addVector4",vector4:"addVector4","enum":"addCombo",combo:"addCombo",button:"addButton",buttons:"addButtons",file:"addFile",line:"addLine",
list:"addList",tree:"addTree",datatree:"addDataTree",pad:"addPad",array:"addArray",separator:"addSeparator"};Inspector.registerWidget=function(c,b){var a="add"+c.charAt(0).toUpperCase()+c.slice(1);Inspector.prototype[a]=b;Inspector.widget_constructors[c]=a};
Inspector.prototype.add=function(c,b,a,e){if(!c)throw"Inspector: no type specified";1==arguments.length&&"object"==typeof c&&(e=c,c=e.type,b=e.name,a=e.value);var d=LiteGUI.Inspector.widget_constructors[c.toLowerCase()];if(d){if(d.constructor===String&&(d=LiteGUI.Inspector.prototype[d]),d&&d.constructor===Function)return e&&e.constructor===Function&&(e={callback:e}),d.call(this,b,a,e)}else console.warn("LiteGUI.Inspector do not have a widget called",c)};Inspector.prototype.getValue=function(c){return this.values[c]};
Inspector.prototype.applyOptions=function(c,b){c&&b&&(b.className&&(c.className+=" "+b.className),b.id&&(c.id=b.id),b.width&&(c.style.width=LiteGUI.sizeToCSS(b.width)),b.height&&(c.style.height=LiteGUI.sizeToCSS(b.height)))};Inspector.prototype.addSeparator=function(){var c=document.createElement("DIV");c.className="separator";this.append(c);return c};Inspector.prototype.addNull=function(c,b,a){return null};
Inspector.prototype.addDefault=function(c,b,a){return null===b||void 0===b?null:b.constructor===Boolean?this.addCheckbox(c,b,a):b.constructor===String?this.addString(c,b,a):b.constructor===Number?this.addNumber(c,b,a):4==b.length?this.addVector4(c,b,a):3==b.length?this.addVector3(c,b,a):2==b.length?this.addVector2(c,b,a):null};
Inspector.prototype.addString=function(c,b,a){a=this.processOptions(a);b=b||"";var e=this;this.values[c]=b;var d="text";a.password&&(d="password");var f=this.createWidget(c,"<span class='inputfield full "+(a.disabled?"disabled":"")+"'><input type='"+d+"' tabIndex='"+this.tab_index+"' "+(a.focus?"autofocus":"")+" class='text string' value='"+b+"' "+(a.disabled?"disabled":"")+"/></span>",a),g=f.querySelector(".wcontent input");"right"==a.align&&(g.style.direction="rtl");g.addEventListener(a.immediate?
"keyup":"change",function(b){b=Inspector.onWidgetChange.call(e,f,c,b.target.value,a);void 0!==b&&(this.value=b)});a.callback_enter&&g.addEventListener("keydown",function(b){13==b.keyCode&&(Inspector.onWidgetChange.call(e,f,c,b.target.value,a),a.callback_enter(),b.preventDefault())});this.tab_index+=1;f.setValue=function(a,b){void 0!==a&&a!==g.value&&(g.value=a,b||LiteGUI.trigger(g,"change"))};f.getValue=function(){return g.value};f.focus=function(){$(this).find("input").focus()};f.wchange=function(a){$(this).wchange(a)};
this.append(f,a);this.processElement(f,a);return f};
Inspector.prototype.addStringButton=function(c,b,a){a=this.processOptions(a);void 0===b&&(b="");var e=this;this.values[c]=b;var d=this.createWidget(c,"<span class='inputfield button'><input type='text' tabIndex='"+this.tab_index+"' class='text string' value='"+b+"' "+(a.disabled?"disabled":"")+"/></span><button class='micro'>"+(a.button||"...")+"</button>",a),f=d.querySelector(".wcontent input");f.addEventListener("change",function(b){b=Inspector.onWidgetChange.call(e,d,c,b.target.value,a);void 0!==
b&&(this.value=b)});b=d.querySelector(".wcontent button");b.addEventListener("click",function(b){a.callback_button&&a.callback_button.call(d,f.value,b)});a.button_width&&(b.style.width=LiteGUI.sizeToCSS(a.button_width),d.querySelector(".inputfield").style.width="calc( 100% - "+b.style.width+" - 6px)");this.tab_index+=1;this.append(d,a);d.wchange=function(a){$(this).wchange(a)};d.wclick=function(a){$(this).wclick(a)};d.setValue=function(a,b){f.value=a;b||LiteGUI.trigger(f,"change")};d.getValue=function(){return f.value};
d.focus=function(){LiteGUI.focus(f)};this.processElement(d,a);return d};
Inspector.prototype.addTextarea=function(c,b,a){a=this.processOptions(a);b=b||"";var e=this;this.values[c]=b;var d=this.createWidget(c,"<span class='inputfield textarea "+(a.disabled?"disabled":"")+"'><textarea tabIndex='"+this.tab_index+"' "+(a.disabled?"disabled":"")+">"+b+"</textarea></span>",a);this.tab_index++;var f=d.querySelector(".wcontent textarea");f.addEventListener(a.immediate?"keyup":"change",function(b){Inspector.onWidgetChange.call(e,d,c,b.target.value,a,!1,b)});a.callback_keydown&&
f.addEventListener("keydown",a.callback_keydown);a.height&&(f.style.height=LiteGUI.sizeToCSS(a.height));this.append(d,a);d.setValue=function(a,b){void 0!==a&&a!=f.value&&(f.value=a,b||LiteGUI.trigger(f,"change"))};this.processElement(d,a);return d};
Inspector.prototype.addNumber=function(c,b,a){a=this.processOptions(a);b=b||0;var e=this;this.values[c]=b;var d=this.createWidget(c,"",a);this.append(d,a);a.extraclass="full";a.tab_index=this.tab_index;a.full=!0;a.precision=void 0!==a.precision?a.precision:2;a.step=void 0===a.step?0==a.precision?1:0.1:a.step;this.tab_index++;var f=null,f=new LiteGUI.Dragger(b,a);f.root.style.width="calc( 100% - 1px )";d.querySelector(".wcontent").appendChild(f.root);f.root.addEventListener("start_dragging",function(a){this.callback_before&&
this.callback_before.call(d)}.bind(a));a.disabled&&f.input.setAttribute("disabled","disabled");var g=d.querySelector("input");g.addEventListener("change",function(b){LiteGUI.trigger(d,"wbeforechange",b.target.value);e.values[c]=b.target.value;if(a.callback){var f=a.callback.call(d,parseFloat(b.target.value));"number"==typeof f&&(this.value=f)}LiteGUI.trigger(d,"wchange",b.target.value);if(e.onchange)e.onchange(c,b.target.value,d)});d.setValue=function(b,c){void 0!==b&&(b=parseFloat(b),a.precision&&
(b=b.toFixed(a.precision)),b+=a.units||"",g.value!=b&&(g.value=b,c||LiteGUI.trigger(g,"change")))};d.getValue=function(){return parseFloat(g.value)};d.focus=function(){LiteGUI.focus(g)};this.processElement(d,a);return d};
Inspector.prototype.addVector2=function(c,b,a){function e(a){this.callback_before&&this.callback_before(a)}a=this.processOptions(a);a.step||(a.step=0.1);b=b||[0,0];var d=this;this.values[c]=b;var f=this.createWidget(c,"",a);a.step=a.step||0.1;a.tab_index=this.tab_index;a.full=!0;this.tab_index++;var g=f.querySelector(".wcontent"),h=new LiteGUI.Dragger(b[0],a);h.root.style.marginLeft=0;h.root.style.width="calc( 50% - 1px )";g.appendChild(h.root);a.tab_index=this.tab_index;this.tab_index++;var k=new LiteGUI.Dragger(b[1],
a);k.root.style.width="calc( 50% - 1px )";g.appendChild(k.root);LiteGUI.bind(h.root,"start_dragging",e.bind(a));LiteGUI.bind(k.root,"start_dragging",e.bind(a));var l=f.querySelectorAll("input");for(b=0;b<l.length;++b)l[b].addEventListener("change",function(b){b=[];for(var e=0;e<l.length;e++)b.push(parseFloat(l[e].value));LiteGUI.trigger(f,"wbeforechange",[b]);d.values[c]=b;if(a.callback){var g=a.callback.call(f,b);if("object"==typeof g&&2<=g.length){for(e=0;e<l.length;e++)l[e].value=g[e];b=g}}LiteGUI.trigger(f,
"wchange",[b]);if(d.onchange)d.onchange(c,b,f)});this.append(f,a);f.setValue=function(a,b){a&&(h.getValue()!=a[0]&&h.setValue(a[0],!0),k.getValue()!=a[1]&&k.setValue(a[1],b))};this.processElement(f,a);return f};
Inspector.prototype.addVector3=function(c,b,a){function e(a){this.callback_before&&this.callback_before()}a=this.processOptions(a);a.step||(a.step=0.1);b=b||[0,0,0];var d=this;this.values[c]=b;var f=this.createWidget(c,"",a);a.step=a.step||0.1;a.tab_index=this.tab_index;a.full=!0;this.tab_index++;var g=new LiteGUI.Dragger(b[0],a);g.root.style.marginLeft=0;g.root.style.width="calc( 33% - 1px )";f.querySelector(".wcontent").appendChild(g.root);a.tab_index=this.tab_index;this.tab_index++;var h=new LiteGUI.Dragger(b[1],
a);h.root.style.width="calc( 33% - 1px )";f.querySelector(".wcontent").appendChild(h.root);a.tab_index=this.tab_index;this.tab_index++;var k=new LiteGUI.Dragger(b[2],a);k.root.style.width="calc( 33% - 1px )";f.querySelector(".wcontent").appendChild(k.root);g.root.addEventListener("start_dragging",e.bind(a));h.root.addEventListener("start_dragging",e.bind(a));k.root.addEventListener("start_dragging",e.bind(a));var l=f.querySelectorAll("input");for(b=0;b<l.length;++b)l[b].addEventListener("change",
function(b){b=[];for(var e=0;e<l.length;e++)b.push(parseFloat(l[e].value));LiteGUI.trigger(f,"wbeforechange",[b]);d.values[c]=b;if(a.callback){var g=a.callback.call(f,b);if("object"==typeof g&&3<=g.length){for(e=0;e<l.length;e++)$(l[e]).val(g[e]);b=g}}LiteGUI.trigger(f,"wchange",[b]);if(d.onchange)d.onchange(c,b,f)});this.append(f,a);f.setValue=function(a,b){a&&(g.setValue(a[0],!0),h.setValue(a[1],!0),k.setValue(a[2],b))};this.processElement(f,a);return f};
Inspector.prototype.addVector4=function(c,b,a){function e(a){this.callback_before&&this.callback_before()}a=this.processOptions(a);a.step||(a.step=0.1);b=b||[0,0,0];var d=this;this.values[c]=b;var f=this.createWidget(c,"",a);a.step=a.step||0.1;a.tab_index=this.tab_index;a.full=!0;this.tab_index++;for(var g=[],h=0;4>h;h++){var k=new LiteGUI.Dragger(b[h],a);k.root.style.marginLeft=0;k.root.style.width="calc( 25% - 1px )";f.querySelector(".wcontent").appendChild(k.root);a.tab_index=this.tab_index;this.tab_index++;
k.root.addEventListener("start_dragging",e.bind(a));g.push(k)}for(var l=f.querySelectorAll("input"),h=0;h<l.length;++h)l[h].addEventListener("change",function(b){b=[];for(var e=0;e<l.length;e++)b.push(parseFloat(l[e].value));LiteGUI.trigger(f,"wbeforechange",[b]);d.values[c]=b;if(a.callback){var g=a.callback.call(f,b);if("object"==typeof g&&4<=g.length){for(e=0;e<l.length;e++)l[e].value=g[e];b=g}}LiteGUI.trigger(f,"wchange",[b]);if(d.onchange)d.onchange(c,b,f)});this.append(f,a);f.setValue=function(a,
b){if(a)for(var c=0;c<g.length;c++)g[c].setValue(a[c],b)};this.processElement(f,a);return f};
Inspector.prototype.addPad=function(c,b,a){a=this.processOptions(a);a.step||(a.step=0.1);b=b||[0,0];var e=this;this.values[c]=b;var d=this.createWidget(c,"",a);a.step=a.step||0.1;a.tab_index=this.tab_index;a.full=!0;this.tab_index++;var f=a.minx||a.min||0,g=a.miny||a.min||0,h=a.maxx||a.max||1,k=a.maxy||a.max||1,l=d.querySelector(".wcontent"),n=document.createElement("div");n.className="litepad";l.appendChild(n);n.style.width="100%";n.style.height="100px";a.background&&(n.style.backgroundImage="url('"+
a.background+"')",n.style.backgroundSize="100%",n.style.backgroundRepeat="no-repeat");var p=document.createElement("div");p.className="litepad-handler";n.appendChild(p);a.tab_index=this.tab_index;this.tab_index++;n._onMouseEvent=function(b){var l=n.getBoundingClientRect();b.mousex=b.pageX-l.left;b.mousey=b.pageY-l.top;b.preventDefault();b.stopPropagation();if("mousedown"==b.type)document.body.addEventListener("mousemove",n._onMouseEvent),document.body.addEventListener("mouseup",n._onMouseEvent);else if("mousemove"==
b.type){var p=b.mousex/l.width;b=b.mousey/l.height;p=p*(h-f)+f;b=b*(k-g)+f;p=[p,b];LiteGUI.trigger(d,"wbeforechange",[p]);d.setValue(p);if(a.callback&&(b=a.callback.call(d,p))&&2<=b.length)for(l=0;l<elems.length;l++)d.setValue(b);LiteGUI.trigger(d,"wchange",[p]);if(e.onchange)e.onchange(c,p,d)}else"mouseup"==b.type&&(document.body.removeEventListener("mousemove",n._onMouseEvent),document.body.removeEventListener("mouseup",n._onMouseEvent));return!0};n.addEventListener("mousedown",n._onMouseEvent);
d.setValue=function(a,b){if(void 0!==a){var c=n.getBoundingClientRect(),d=(a[0]-f)/(h-f),e=(a[1]-g)/(k-g),d=Math.max(0,Math.min(d,1)),e=Math.max(0,Math.min(e,1)),l=(c.height-10)/c.height*100;p.style.left=((c.width-10)/c.width*d*100).toFixed(1)+"%";p.style.top=(e*l).toFixed(1)+"%"}};this.append(d,a);d.setValue(b);this.processElement(d,a);return d};
Inspector.prototype.addInfo=function(c,b,a){a=this.processOptions(a);b=void 0===b||null===b?"":b;var e=null;null!=c?e=this.createWidget(c,b,a):(e=document.createElement("div"),a.className&&(e.className=a.className),void 0!==b.nodeName?(e.innerHTML="<span class='winfo'></span>",e.childNodes[0].appendChild(b)):e.innerHTML="<span class='winfo'>"+b+"</span>");var d=e.querySelector(".winfo")||e.querySelector(".wcontent");e.setValue=function(a){void 0!==a&&d&&(d.innerHTML=a)};if(a.height){c=e.querySelector("span.info_content");
if(!c)return;c.style.height=LiteGUI.sizeToCSS(a.height);c.style.overflow="auto"}this.append(e,a);this.processElement(e,a);return e};
Inspector.prototype.addSlider=function(c,b,a){a=this.processOptions(a);void 0===a.min&&(a.min=0);void 0===a.max&&(a.max=1);void 0===a.step&&(a.step=0.01);var e=this;if(void 0===b||null===b)b=0;this.values[c]=b;var d=this.createWidget(c,"<span class='inputfield full'>\t\t\t\t<input tabIndex='"+this.tab_index+"' type='text' class='slider-text fixed nano' value='"+b+"' /><span class='slider-container'></span></span>",a),f=d.querySelector(".slider-container"),g=new LiteGUI.Slider(b,a);f.appendChild(g.root);
var h=d.querySelector(".slider-text");h.addEventListener("change",function(f){b=f=parseFloat(this.value);g.setValue(f);Inspector.onWidgetChange.call(e,d,c,f,a)});g.root.addEventListener("change",function(f){b=f.detail;h.value=b;Inspector.onWidgetChange.call(e,d,c,b,a)});this.append(d,a);d.setValue=function(a,c){void 0!==a&&(b=a,g.setValue(a,c))};d.getValue=function(){return b};this.processElement(d,a);return d};
Inspector.prototype.addCheckbox=function(c,b,a){a=this.processOptions(a);b=b||"";var e=this;this.values[c]=b;var d=a.label_on||a.label||"on",f=a.label_off||a.label||"off",g=this.createWidget(c,"<span class='inputfield'><span tabIndex='"+this.tab_index+"' class='fixed flag checkbox "+(b?"on":"off")+"'>"+(b?d:f)+"</span></span>",a);this.tab_index++;var h=g.querySelector(".wcontent .checkbox");h.addEventListener("keypress",function(a){32==a.keyCode&&LiteGUI.trigger(this,"click")});g.addEventListener("click",
function(){var b=!this.data;this.data=b;g.querySelector("span.flag").innerHTML=b?d:f;b?h.classList.add("on"):h.classList.remove("on");Inspector.onWidgetChange.call(e,g,c,b,a)});g.data=b;g.setValue=function(a,b){void 0!==a&&(e.values[c]==a||b||LiteGUI.trigger(h,"click"))};this.append(g,a);this.processElement(g,a);return g};
Inspector.prototype.addFlags=function(c,b,a){var e={},d;for(d in c)e[d]=c[d];if(b)for(d in b)"undefined"==typeof e[d]&&(e[d]=b[d]?!0:!1);for(d in e){b={};for(var f in a)b[f]=a[f];b.callback=function(a){return function(b){c[a]=b}}(d);this.addCheckbox(d,e[d],b)}};
Inspector.prototype.addCombo=function(c,b,a){function e(a,c){a||(a=[]);g=a;c&&(b=c);var d="",e=0,h;for(h in g){var k=g[h],s=g.constructor===Array?e:h,u=g.constructor===Array?k:h;k&&k.title&&(u=k.title);d+="<option value='"+s+"' "+(k==b?" selected":"")+" data-index='"+s+"'>"+u+"</option>";e++}f.querySelector("select").innerHTML=d}a=this.processOptions(a);var d=this;this.values[c]=b;this.tab_index++;var f=this.createWidget(c,"<span class='inputfield full inputcombo "+(a.disabled?"disabled":"")+"'></span>",
a);f.options=a;var g=a.values||[];g.constructor===Function&&(g=a.values());var h="<select tabIndex='"+this.tab_index+"' "+(a.disabled?"disabled":"")+" class='"+(a.disabled?"disabled":"")+"'></select>";f.querySelector("span.inputcombo").innerHTML=h;e(g);var k=!1;f.querySelector(".wcontent select").addEventListener("change",function(b){b=g[b.target.value];k||Inspector.onWidgetChange.call(d,f,c,b,a)});f.setValue=function(a,c){if(void 0!==a){b=a;var d=f.querySelector("select"),e=d.querySelectorAll("option"),
h=-1;if(g.constructor===Array)h=g.indexOf(a);else{var r=0,s;for(s in g)if(g[r]==a){h=r;break}else r++}if(-1!=h){k=c;for(s in e)(r=e[s])&&r.dataset&&(parseFloat(r.dataset.index)==h?(r.setAttribute("selected",!0),d.selectedIndex=h):r.removeAttribute("selected"));k=!1}}};f.setOptionValues=e;this.append(f,a);this.processElement(f,a);return f};
Inspector.prototype.addComboButtons=function(c,b,a){a=this.processOptions(a);b=b||"";var e=this;this.values[c]=b;var d="";if(a.values)for(var f in a.values)d+="<button class='wcombobutton "+(b==a.values[f]?"selected":"")+"' data-name='options.values[i]'>"+a.values[f]+"</button>";var g=this.createWidget(c,d,a);b=g.querySelectorAll(".wcontent button");LiteGUI.bind(b,"click",function(b){b=b.target.innerHTML;e.values[c]=b;var d=g.querySelectorAll(".selected"),f;for(f in d)d.classList.remove("selected");
this.classList.add("selected");Inspector.onWidgetChange.call(e,g,c,b,a)});this.append(g,a);this.processElement(g,a);return g};
Inspector.prototype.addTags=function(c,b,a){function e(b){if(!g.tags[b]){LiteGUI.trigger(g,"wbeforechange",g.tags);g.tags[b]=!0;var e=document.createElement("div");e.data=b;e.className="wtag";e.innerHTML=b+"<span class='close'>X</span>";e.querySelector(".close").addEventListener("click",function(b){b=this.parentNode.data;delete g.tags[b];LiteGUI.remove(this.parentNode);LiteGUI.trigger(g,"wremoved",b);Inspector.onWidgetChange.call(d,g,c,g.tags,a)});g.querySelector(".wtagscontainer").appendChild(e);
d.values[c]=g.tags;a.callback&&a.callback.call(g,g.tags);LiteGUI.trigger(g,"wchange",g.tags);LiteGUI.trigger(g,"wadded",b);if(d.onchange)d.onchange(c,g.tags,g)}}a=this.processOptions(a);b=b||[];var d=this;this.values[c]=b;b="<select>";if(a.values)for(var f in a.values)b+="<option>"+a.values[f]+"</option>";var g=this.createWidget(c,"<span class='inputfield full'>"+(b+"</select><div class='wtagscontainer inputfield'></div>")+"</span>",a);g.tags={};for(f in a.value)e(a.value[f]);g.querySelector(".wcontent select").addEventListener("change",
function(a){e(a.target.value)});this.append(g,a);this.processElement(g,a);return g};
Inspector.prototype.addList=function(c,b,a){function e(a){var b=k.querySelector("li.selected");if(b){if(40==a.keyCode)(b=b.nextSibling)&&LiteGUI.trigger(b,"click");else if(38==a.keyCode)(b=b.previousSibling)&&LiteGUI.trigger(b,"click");else return;a.preventDefault();a.stopPropagation();return!0}}function d(d){if(a.multiselection)this.classList.toggle("selected");else{d=k.querySelectorAll("li");for(var e=0;e<d.length;++e)d[e].classList.remove("selected");this.classList.add("selected")}d=b[this.dataset.pos];
Inspector.onWidgetChange.call(g,k,c,d,a);LiteGUI.trigger(k,"wadded",d)}function f(c){c=b[this.dataset.pos];a.callback_dblclick&&a.callback_dblclick.call(g,c)}a=this.processOptions(a);var g=this,h="";a.height&&(h="style='height: "+a.height+"px; overflow: auto;'");h="<ul class='lite-list' "+h+" tabIndex='"+this.tab_index+"'><ul>";this.tab_index++;for(var k=this.createWidget(c,"<span class='inputfield full "+(a.disabled?"disabled":"")+"'>"+h+"</span>",a),h=k.querySelectorAll("ul"),l=0;l<h.length;++l){var n=
h[l];n.addEventListener("focus",function(){document.addEventListener("keydown",e,!0)});n.addEventListener("blur",function(){document.removeEventListener("keydown",e,!0)})}k.updateItems=function(c,e){e=e||a.selected;b=c;var g=this.querySelector("ul");g.innerHTML="";if(b)for(var h in b){var k=b[h],l=b.constructor===Array?k:h;l||(l=h);var n=l.constructor===String?l:h,y=null;l&&l.constructor===String&&(l=l.replace(/<(?:.|\n)*?>/gm,""));var z="";null!==k&&void 0!==k&&k.constructor!==String&&k.constructor!==
Number&&k.constructor!==Boolean&&k&&(n=k.content||k.name||h,y=k.style,k.icon&&(z="<img src='"+k.icon+"' class='icon' />"));k=!1;if("object"==typeof b[h]&&b[h].selected||e==b[h])k=!0;var t=document.createElement("li");t.classList.add("item-"+LiteGUI.safeName(h));k&&t.classList.add("selected");t.dataset.name=l;t.dataset.pos=h;y&&t.setAttribute("style",y);t.innerHTML=z+n;g.appendChild(t);t.addEventListener("click",d);a.callback_dblclick&&t.addEventListener("dblclick",f)}LiteGUI.bind(g.querySelectorAll("li"),
"click",d)};k.removeItem=function(a){for(var b=k.querySelectorAll(".wcontent li"),c=0;c<b.length;c++)b[c].dataset.name==a&&LiteGUI.remove(b[c])};k.updateItems(b,a.selected);this.append(k,a);k.getSelected=function(){for(var a=[],b=this.querySelectorAll("ul li.selected"),c=0;c<b.length;++c)a.push(b[c].dataset.name);return a};k.getIndex=function(a){return this.querySelectorAll("ul li")[a]};k.selectIndex=function(a,b){for(var c=this.querySelectorAll("ul li"),d=0;d<c.length;++d){var e=c[d];d==a?e.classList.add("selected"):
b||e.classList.remove("selected")}return c[a]};k.scrollToIndex=function(a){if(a=this.querySelectorAll("ul li")[a])this.scrollTop=a.offsetTop};k.selectAll=function(){for(var a=this.querySelectorAll("ul li"),b=0;b<a.length;++b){var c=a[b];c.classList.contains("selected")||LiteGUI.trigger(c,"click")}};k.setValue=function(a){void 0!==a&&this.updateItems(a)};a.height&&(k.scrollTop=0);this.processElement(k,a);return k};
Inspector.prototype.addButton=function(c,b,a){a=this.processOptions(a);b=a.button_text||b||"";var e=this,d="";null===c&&(d="single");a.micro&&(d+=" micro");var f="";a.disabled&&(f="disabled='disabled'");var g=this.createWidget(c,"<button class='litebutton "+d+"' tabIndex='"+this.tab_index+"' "+f+">"+b+"</button>",a);this.tab_index++;var h=g.querySelector("button");h.addEventListener("click",function(d){Inspector.onWidgetChange.call(e,g,c,this.innerHTML,a,!1,d);LiteGUI.trigger(h,"wclick",b)});this.append(g,
a);g.wclick=function(b){a.disabled||LiteGUI.bind(this,"wclick",b)};g.setValue=function(a){void 0!==a&&(h.innerHTML=a)};this.processElement(g,a);return g};
Inspector.prototype.addButtons=function(c,b,a){a=this.processOptions(a);b=b||"";var e=this,d="",f="calc( "+(100/b.length).toFixed(3)+"% - 4px )",f="width:"+f+"; width: -moz-"+f+"; width: -webkit-"+f+"; margin: 2px;";if(b&&"object"==typeof b)for(var g in b)d+="<button class='litebutton' tabIndex='"+this.tab_index+"' style='"+f+"'>"+b[g]+"</button>",this.tab_index++;var h=this.createWidget(c,d,a);b=h.querySelectorAll("button");for(g=0;g<b.length;++g)b[g].addEventListener("click",function(b){Inspector.onWidgetChange.call(e,
h,c,this.innerHTML,a,null,b);LiteGUI.trigger(h,"wclick",this.innerHTML)});this.append(h,a);this.processElement(h,a);return h};
Inspector.prototype.addIcon=function(c,b,a){a=this.processOptions(a);b=b||"";var e=this,d=a.image,f=a.width||a.size||20,g=a.height||a.size||20,h=this.createWidget(c,"<span class='icon' "+(a.title?"title='"+a.title+"'":"")+" tabIndex='"+this.tab_index+"'></span>",a);this.tab_index++;var k=h.querySelector("span.wcontent"),l=h.querySelector("span.icon"),n=a.x||0;a.index&&(n=a.index*-f);h.style.minWidth=h.style.width=f+"px";h.style.margin="0 2px";h.style.padding="0";k.style.margin="0";k.style.padding=
"0";l.style.display="inline-block";l.style.cursor="pointer";l.style.width=f+"px";l.style.height=g+"px";l.style.backgroundImage="url('"+d+"')";l.style.backgroundPosition=n+"px "+(b?g:0)+"px";l.addEventListener("mousedown",function(d){d.preventDefault();b=!b;d=Inspector.onWidgetChange.call(e,h,c,b,a);LiteGUI.trigger(h,"wclick",b);void 0!==d&&(b=d);l.style.backgroundPosition=n+"px "+(b?g:0)+"px";!1===a.toggle&&setTimeout(function(){l.style.backgroundPosition=n+"px 0px";b=!1},200)});this.append(h,a);
h.setValue=function(d,f){void 0!==d&&(b=d,l.style.backgroundPosition=n+"px "+(b?g:0)+"px",f||Inspector.onWidgetChange.call(e,h,c,b,a))};h.getValue=function(){return b};this.processElement(h,a);return h};
Inspector.prototype.addColor=function(c,b,a){a=this.processOptions(a);b=b||[0,0,0];var e=this;this.values[c]=b;var d="<input tabIndex='"+this.tab_index+"' id='colorpicker-"+c+"' class='color' value='"+(b[0]+","+b[1]+","+b[2])+"' "+(a.disabled?"disabled":"")+"/>";this.tab_index++;a.show_rgb&&(d+="<span class='rgb-color'>"+Inspector.parseColor(b)+"</span>");var f=this.createWidget(c,d,a);this.append(f,a);var d=f.querySelector("input.color"),g=null;if(window.jscolor){g=new jscolor.color(d);g.pickerFaceColor=
"#333";g.pickerBorderColor="black";g.pickerInsetColor="#222";g.rgb_intensity=1;a.disabled&&(g.pickerOnfocus=!1);b.constructor!==String&&b.length&&2<b.length&&(g.fromRGB(1*b[0],1*b[1],1*b[2]),g.rgb_intensity=1);d.addEventListener("change",function(a){if(a=f.querySelector(".rgb-color"))a.innerHTML=LiteGUI.Inspector.parseColor(g.rgb)});g.onImmediateChange=function(){var b=[g.rgb[0]*g.rgb_intensity,g.rgb[1]*g.rgb_intensity,g.rgb[2]*g.rgb_intensity],d=[b.concat(),g.toString()];LiteGUI.trigger(f,"wbeforechange",
d);e.values[c]=b;a.callback&&a.callback.call(f,b.concat(),"#"+g.toString(),g);LiteGUI.trigger(f,"wchange",d);if(e.onchange)e.onchange(c,b.concat(),f)};a.step=a.step||0.01;a.dragger_class="nano";var h=new LiteGUI.Dragger(1,a);f.querySelector(".wcontent").appendChild(h.root);h.input.addEventListener("change",function(a){a=parseFloat(this.value);g.rgb_intensity=a;if(g.onImmediateChange)g.onImmediateChange()});f.setValue=function(a,b){g.fromRGB(a[0],a[1],a[2]);b||LiteGUI.trigger(h.input,"change")}}else d.addEventListener("change",
function(a){if(a=f.querySelector(".rgb-color"))a.innerHTML=LiteGUI.Inspector.parseColor(g.rgb)});this.processElement(f,a);return f};
Inspector.prototype.addFile=function(c,b,a){a=this.processOptions(a);b=b||"";var e=this;this.values[c]=b;var d=this.createWidget(c,"<span class='inputfield full whidden' style='width: calc(100% - 26px)'><span class='filename'>"+b+"</span></span><button class='litebutton' style='width:20px; margin-left: 2px;'>...</button><input type='file' size='100' class='file' value='"+b+"'/>",a);d.querySelector(".wcontent").style.position="relative";b=d.querySelector(".wcontent input");var f=d.querySelector(".wcontent .filename");
b.addEventListener("change",function(b){if(b.target.files.length){var h=null;a.generate_url&&(h=URL.createObjectURL(b.target.files[0]));var k={url:h,filename:b.target.value,file:b.target.files[0],files:b.target.files};a.read_file?(b=new FileReader,b.onload=function(b){k.data=b.target.result;Inspector.onWidgetChange.call(e,d,c,k,a)},"binary"==a.read_file?b.readAsArrayBuffer(k.file):"data_url"==a.read_file?b.readAsDataURL(k.file):b.readAsText(k.file)):(f.innerHTML=b.target.files[0].name,Inspector.onWidgetChange.call(e,
d,c,k,a))}else f.innerHTML="",Inspector.onWidgetChange.call(e,d,c,null,a)});this.append(d,a);return d};
Inspector.prototype.addLine=function(c,b,a){a=this.processOptions(a);b=b||"";var e=this;this.values[c]=b;var d=this.createWidget(c,"<span class='line-editor'></span>",a);b=new LiteGUI.LineEditor(b,a);d.querySelector("span.line-editor").appendChild(b);LiteGUI.bind(b,"change",function(b){LiteGUI.trigger(d,"wbeforechange",[b.target.value]);a.callback&&a.callback.call(d,b.target.value);LiteGUI.trigger(d,"wchange",[b.target.value]);Inspector.onWidgetChange.call(e,d,c,b.target.value,a)});this.append(d,
a);return d};
Inspector.prototype.addTree=function(c,b,a){a=this.processOptions(a);b=b||"";var e=this.createWidget(c,"<div class='wtree inputfield full'></div>",a);c=e.querySelector(".wtree");a.height&&(c.style.height="number"==typeof a.height?a.height+"px":a.height,c.style.overflow="auto");var d=e.tree=new LiteGUI.Tree(null,b,a.tree_options);d.onItemSelected=function(b,c){a.callback&&a.callback.call(e,b,c)};c.appendChild(d.root);e.setValue=function(a){d.updateTree(a)};this.append(e,a);this.processElement(e,a);
return e};
Inspector.prototype.addDataTree=function(c,b,a){function e(a,b){for(var c in b){var d=document.createElement("div");d.className="treenode";"object"==typeof b[c]?(d.innerHTML="<span class='itemname'>"+c+"</span><span class='itemcontent'></span>",e(d.querySelector(".itemcontent"),b[c])):d.innerHTML="<span class='itemname'>"+c+"</span><span class='itemvalue'>"+b[c]+"</span>";a.appendChild(d)}}a=this.processOptions(a);b=b||"";c=this.createWidget(c,"<div class='wtree'></div>",a);var d=c.querySelector(".wtree");e(d,
b);this.append(c,a);return c};
Inspector.prototype.addArray=function(c,b,a){function e(){var b=this.value,c=h.length,e=b.length;if(e<c){for(var n=e;n<h.length;++n)h[n]&&h[n].remove();h.length=e}if(e>c)for(n=c;n<e&&n<l;++n){c=null;void 0!==b[n]&&(c=b[n]);var s={widget_parent:g,name_width:30,callback:d.bind({value:this.value,index:n})};if(a.data_options)for(var u in a.data_options)s[u]=a.data_options[u];c=f.add(k,n,c,s);h.push(c)}}function d(b){this.value[this.index]=b;a.callback&&a.callback.call(g,this.value,this.index)}var f=this;
if(b&&b.constructor===Array){a=this.processOptions(a);var g=this.addContainer(c,a),h=[],k=a.data_type||"string";g.value=b;var l=a.max_items||100;this.widgets_per_row=3;this.addInfo(c,null,{width:100});var n=this.addString("length",b.length||"0",function(a){b.length=parseInt(a);e.call(g)});this.addButtons(null,["+","-"],function(a){"+"==a?b.length+=1:0<b.length&&(b.length-=1);n.setValue(b.length);e.call(g)});this.widgets_per_row=1;e.call(g);g.setValue=function(a){this.value=a;e.call(this)};g.getValue=
function(){return this.value=v};return g}console.error("Inspector: Array widget value must be a valid array")};Inspector.prototype.addContainer=function(c,b){var a=this.startContainer(null,b);this.endContainer();return a};
Inspector.prototype.startContainer=function(c,b){b=this.processOptions(b);var a=document.createElement("DIV");a.className="wcontainer";this.applyOptions(a,b);this.row_number=0;this.append(a);this.pushContainer(a);b.widgets_per_row&&(this.widgets_per_row=b.widgets_per_row);b.height&&(a.style.height=LiteGUI.sizeToCSS(b.height),a.style.overflow="auto");a.refresh=function(){a.on_refresh&&a.on_refresh.call(this,a)};return a};Inspector.prototype.endContainer=function(c,b){this.popContainer()};
Inspector.prototype.addSection=function(c,b){b=this.processOptions(b);var a=this;this.current_section&&this.current_section.end();var e=document.createElement("DIV");e.className="wsection";c||(e.className+=" notitle");b.className&&(e.className+=" "+b.className);b.collapsed&&(e.className+=" collapsed");b.id&&(e.id=b.id);b.instance&&(e.instance=b.instance);var d="";c&&(d+="<div class='wsectiontitle'>"+(b.no_collapse?"":"<span class='switch-section-button'></span>")+c+"</div>");e.innerHTML=d+"<div class='wsectioncontent'></div>";
e._last_container_stack=this._current_container_stack.concat();this.root.appendChild(e);this.sections.push(e);e.sectiontitle=e.querySelector(".wsectiontitle");c&&e.sectiontitle.addEventListener("click",function(a){"button"!=a.target.localName&&(e.classList.toggle("collapsed"),a=e.querySelector(".wsectioncontent"),a.style.display="none"===a.style.display?null:"none",b.callback&&b.callback.call(e,!e.classList.contains("collapsed")))});b.collapsed&&(e.querySelector(".wsectioncontent").style.display=
"none");this.setCurrentSection(e);b.widgets_per_row&&(this.widgets_per_row=b.widgets_per_row);e.refresh=function(){e.on_refresh&&e.on_refresh.call(this,e)};e.end=function(){if(a.current_section==this){a._current_container_stack=this._last_container_stack;var b=this.querySelector(".wsectioncontent");b&&(a.isContainerInStack(b)&&a.popContainer(b),a.current_section=null)}};return e};
Inspector.prototype.setCurrentSection=function(c){this.current_section!=c&&(this.current_section=c,this.popContainer(c.parentNode),c=c.querySelector(".wsectioncontent"),this.pushContainer(c))};Inspector.prototype.getCurrentSection=function(){for(var c=this._current_container_stack.length-1;0<=c;--c){var b=this._current_container_stack[c];if(b.classList.contains("wsectioncontent"))return b.parentNode}return null};Inspector.prototype.endCurrentSection=function(){this.current_section&&this.current_section.end()};
Inspector.prototype.beginGroup=function(c,b){b=this.processOptions(b);var a=document.createElement("DIV");a.className="wgroup";a.innerHTML="<div class='wgroupheader "+(b.title?"wtitle":"")+"'><span class='wgrouptoggle'>-</span>"+(c||"")+"</div>";a.group=!0;var e=document.createElement("DIV");e.className="wgroupcontent";b.collapsed&&(e.style.display="none");a.appendChild(e);var d=b.collapsed||!1;a.querySelector(".wgroupheader").addEventListener("click",function(){var b=a.querySelector(".wgroupcontent").style;
b.display="none"===b.display?"":"none";d=!d;a.querySelector(".wgrouptoggle").innerHTML=d?"+":"-"});this.append(a,b);this.pushContainer(e);return a};Inspector.prototype.endGroup=function(){for(;this._current_container&&!this._current_container.classList.contains("wgroupcontent");)this.popContainer()};
Inspector.prototype.addTitle=function(c,b){b=this.processOptions(b);var a=document.createElement("DIV"),e="<span class='wtitle'><span class='text'>"+c+"</span>";b.help&&(e+="<span class='help'><div class='help-content'>"+b.help+"</div></span>");a.innerHTML=e+"</span>";a.setValue=function(a){this.querySelector(".text").innerHTML=a};this.row_number=0;this.append(a,b);return a};
Inspector.prototype.scrollTo=function(c){if(c=this.root.querySelector("#"+c))this.root.parentNode.parentNode.scrollTop=c.offsetTop-this.root.offsetTop};Inspector.prototype.processOptions=function(c){"function"==typeof c&&(c={callback:c});return c||{}};Inspector.prototype.processElement=function(c,b){b.callback_update&&c.setValue&&(c.on_update=function(){this.setValue(b.callback_update.call(this),!0)})};
Inspector.prototype.updateWidgets=function(){for(var c=0;c<this.widgets.length;++c){var b=this.widgets[c];if(b.on_update)b.on_update(b)}};Inspector.parseColor=function(c){return"<span style='color: #FAA'>"+c[0].toFixed(2)+"</span>,<span style='color: #AFA'>"+c[1].toFixed(2)+"</span>,<span style='color: #AAF'>"+c[2].toFixed(2)+"</span>"};LiteGUI.Inspector=Inspector;
